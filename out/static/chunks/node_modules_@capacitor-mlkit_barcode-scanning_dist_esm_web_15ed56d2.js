(globalThis.TURBOPACK || (globalThis.TURBOPACK = [])).push([typeof document === "object" ? document.currentScript : undefined,
"[project]/node_modules/@capacitor-mlkit/barcode-scanning/dist/esm/web.js [app-client] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "BarcodeScannerWeb",
    ()=>BarcodeScannerWeb
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$capacitor$2f$core$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@capacitor/core/dist/index.js [app-client] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$capacitor$2d$mlkit$2f$barcode$2d$scanning$2f$dist$2f$esm$2f$definitions$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@capacitor-mlkit/barcode-scanning/dist/esm/definitions.js [app-client] (ecmascript)");
;
;
class BarcodeScannerWeb extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$capacitor$2f$core$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["WebPlugin"] {
    async startScan(options) {
        if (!this._isSupported) {
            throw this.createUnimplementedException();
        }
        if (!(options === null || options === void 0 ? void 0 : options.videoElement)) {
            throw new Error(this.errorVideoElementMissing);
        }
        this.videoElement = options.videoElement;
        this.stream = await navigator.mediaDevices.getUserMedia({
            video: {
                facingMode: {
                    ideal: (options === null || options === void 0 ? void 0 : options.lensFacing) === __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$capacitor$2d$mlkit$2f$barcode$2d$scanning$2f$dist$2f$esm$2f$definitions$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["LensFacing"].Front ? 'user' : 'environment'
                }
            },
            audio: false
        });
        options.videoElement.srcObject = this.stream;
        await options.videoElement.play();
        const barcodeDetector = new BarcodeDetector();
        this.intervalId = window.setInterval(async ()=>{
            if (!options.videoElement) {
                return;
            }
            const barcodes = await barcodeDetector.detect(options.videoElement);
            if (barcodes.length === 0) {
                return;
            } else {
                this.handleScannedBarcodes(barcodes);
            }
        }, 500);
    }
    async stopScan() {
        if (!this._isSupported) {
            throw this.createUnimplementedException();
        }
        if (this.intervalId) {
            clearInterval(this.intervalId);
            this.intervalId = undefined;
        }
        if (this.stream) {
            this.stream.getTracks().forEach((track)=>track.stop());
            this.stream = undefined;
        }
        if (this.videoElement) {
            this.videoElement.srcObject = null;
            this.videoElement = undefined;
        }
    }
    async readBarcodesFromImage(_options) {
        throw this.createUnimplementedException();
    }
    async scan() {
        throw this.createUnimplementedException();
    }
    async isSupported() {
        return {
            supported: this._isSupported
        };
    }
    async enableTorch() {
        throw this.createUnimplementedException();
    }
    async disableTorch() {
        throw this.createUnimplementedException();
    }
    async toggleTorch() {
        throw this.createUnimplementedException();
    }
    async isTorchEnabled() {
        throw this.createUnimplementedException();
    }
    async isTorchAvailable() {
        return {
            available: false
        };
    }
    async setZoomRatio(_options) {
        throw this.createUnimplementedException();
    }
    async getZoomRatio() {
        throw this.createUnimplementedException();
    }
    async getMinZoomRatio() {
        throw this.createUnimplementedException();
    }
    async getMaxZoomRatio() {
        throw this.createUnimplementedException();
    }
    async openSettings() {
        throw this.createUnimplementedException();
    }
    async isGoogleBarcodeScannerModuleAvailable() {
        throw this.createUnimplementedException();
    }
    async installGoogleBarcodeScannerModule() {
        throw this.createUnimplementedException();
    }
    async checkPermissions() {
        try {
            const result = await navigator.permissions.query({
                name: 'camera'
            });
            return {
                camera: result.state
            };
        } catch (error) {
            return {
                camera: 'prompt'
            };
        }
    }
    async requestPermissions() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({
                video: true
            });
            stream.getTracks().forEach((track)=>track.stop());
            return {
                camera: 'granted'
            };
        } catch (error) {
            return {
                camera: 'denied'
            };
        }
    }
    createUnimplementedException() {
        return new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$capacitor$2f$core$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["CapacitorException"]('This method is not implemented on web.', __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$capacitor$2f$core$2f$dist$2f$index$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["ExceptionCode"].Unimplemented);
    }
    handleScannedBarcodes(barcodes) {
        const result = {
            barcodes: barcodes.map((barcode)=>({
                    cornerPoints: [
                        [
                            barcode.cornerPoints[0].x,
                            barcode.cornerPoints[0].y
                        ],
                        [
                            barcode.cornerPoints[1].x,
                            barcode.cornerPoints[1].y
                        ],
                        [
                            barcode.cornerPoints[2].x,
                            barcode.cornerPoints[2].y
                        ],
                        [
                            barcode.cornerPoints[3].x,
                            barcode.cornerPoints[3].y
                        ]
                    ],
                    displayValue: barcode.rawValue,
                    rawValue: barcode.rawValue,
                    format: barcode.format.toUpperCase(),
                    valueType: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$capacitor$2d$mlkit$2f$barcode$2d$scanning$2f$dist$2f$esm$2f$definitions$2e$js__$5b$app$2d$client$5d$__$28$ecmascript$29$__["BarcodeValueType"].Unknown
                }))
        };
        this.notifyListeners(this.eventBarcodesScanned, result);
    }
    constructor(){
        super(...arguments);
        this._isSupported = 'BarcodeDetector' in window;
        this.errorVideoElementMissing = 'videoElement must be provided.';
        this.eventBarcodesScanned = 'barcodesScanned';
    }
} //# sourceMappingURL=web.js.map
}),
]);

//# sourceMappingURL=node_modules_%40capacitor-mlkit_barcode-scanning_dist_esm_web_15ed56d2.js.map