{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@capacitor-mlkit/barcode-scanning/dist/esm/web.js","sourceRoot":"","sources":["file:///home/user/studio/node_modules/%40capacitor-mlkit/barcode-scanning/src/web.ts"],"sourcesContent":["import { CapacitorException, ExceptionCode, WebPlugin } from '@capacitor/core';\n\nimport type { DetectedBarcode } from './barcode-detector';\nimport { BarcodeValueType, LensFacing } from './definitions';\nimport type {\n  BarcodeFormat,\n  BarcodesScannedEvent,\n  BarcodeScannerPlugin,\n  GetMaxZoomRatioResult,\n  GetMinZoomRatioResult,\n  GetZoomRatioResult,\n  IsGoogleBarcodeScannerModuleAvailableResult,\n  IsSupportedResult,\n  PermissionStatus,\n  ReadBarcodesFromImageOptions,\n  ReadBarcodesFromImageResult,\n  ScanResult,\n  SetZoomRatioOptions,\n  StartScanOptions,\n  IsTorchEnabledResult,\n  IsTorchAvailableResult,\n} from './definitions';\n\ndeclare global {\n  // eslint-disable-next-line @typescript-eslint/consistent-type-imports\n  const BarcodeDetector: typeof import('./barcode-detector').BarcodeDetector;\n}\n\nexport class BarcodeScannerWeb\n  extends WebPlugin\n  implements BarcodeScannerPlugin\n{\n  private readonly _isSupported = 'BarcodeDetector' in window;\n  private readonly errorVideoElementMissing = 'videoElement must be provided.';\n  private readonly eventBarcodesScanned = 'barcodesScanned';\n\n  private intervalId: number | undefined;\n  private stream: MediaStream | undefined;\n  private videoElement: HTMLVideoElement | undefined;\n\n  async startScan(options?: StartScanOptions): Promise<void> {\n    if (!this._isSupported) {\n      throw this.createUnimplementedException();\n    }\n    if (!options?.videoElement) {\n      throw new Error(this.errorVideoElementMissing);\n    }\n    this.videoElement = options.videoElement;\n    this.stream = await navigator.mediaDevices.getUserMedia({\n      video: {\n        facingMode: {\n          ideal:\n            options?.lensFacing === LensFacing.Front ? 'user' : 'environment',\n        },\n      },\n      audio: false,\n    });\n    options.videoElement.srcObject = this.stream;\n    await options.videoElement.play();\n    const barcodeDetector = new BarcodeDetector();\n    this.intervalId = window.setInterval(async () => {\n      if (!options.videoElement) {\n        return;\n      }\n      const barcodes = await barcodeDetector.detect(options.videoElement);\n      if (barcodes.length === 0) {\n        return;\n      } else {\n        this.handleScannedBarcodes(barcodes);\n      }\n    }, 500);\n  }\n\n  async stopScan(): Promise<void> {\n    if (!this._isSupported) {\n      throw this.createUnimplementedException();\n    }\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = undefined;\n    }\n    if (this.stream) {\n      this.stream.getTracks().forEach(track => track.stop());\n      this.stream = undefined;\n    }\n    if (this.videoElement) {\n      this.videoElement.srcObject = null;\n      this.videoElement = undefined;\n    }\n  }\n\n  async readBarcodesFromImage(\n    _options: ReadBarcodesFromImageOptions,\n  ): Promise<ReadBarcodesFromImageResult> {\n    throw this.createUnimplementedException();\n  }\n\n  async scan(): Promise<ScanResult> {\n    throw this.createUnimplementedException();\n  }\n\n  async isSupported(): Promise<IsSupportedResult> {\n    return { supported: this._isSupported };\n  }\n\n  async enableTorch(): Promise<void> {\n    throw this.createUnimplementedException();\n  }\n\n  async disableTorch(): Promise<void> {\n    throw this.createUnimplementedException();\n  }\n\n  async toggleTorch(): Promise<void> {\n    throw this.createUnimplementedException();\n  }\n\n  async isTorchEnabled(): Promise<IsTorchEnabledResult> {\n    throw this.createUnimplementedException();\n  }\n\n  async isTorchAvailable(): Promise<IsTorchAvailableResult> {\n    return { available: false };\n  }\n\n  async setZoomRatio(_options: SetZoomRatioOptions): Promise<void> {\n    throw this.createUnimplementedException();\n  }\n\n  async getZoomRatio(): Promise<GetZoomRatioResult> {\n    throw this.createUnimplementedException();\n  }\n\n  async getMinZoomRatio(): Promise<GetMinZoomRatioResult> {\n    throw this.createUnimplementedException();\n  }\n\n  async getMaxZoomRatio(): Promise<GetMaxZoomRatioResult> {\n    throw this.createUnimplementedException();\n  }\n\n  async openSettings(): Promise<void> {\n    throw this.createUnimplementedException();\n  }\n\n  async isGoogleBarcodeScannerModuleAvailable(): Promise<IsGoogleBarcodeScannerModuleAvailableResult> {\n    throw this.createUnimplementedException();\n  }\n\n  async installGoogleBarcodeScannerModule(): Promise<void> {\n    throw this.createUnimplementedException();\n  }\n\n  async checkPermissions(): Promise<PermissionStatus> {\n    try {\n      const result = await navigator.permissions.query({\n        name: 'camera' as any,\n      });\n      return {\n        camera: result.state,\n      };\n    } catch (error) {\n      return {\n        camera: 'prompt',\n      };\n    }\n  }\n\n  async requestPermissions(): Promise<PermissionStatus> {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n      stream.getTracks().forEach(track => track.stop());\n      return {\n        camera: 'granted',\n      };\n    } catch (error) {\n      return {\n        camera: 'denied',\n      };\n    }\n  }\n\n  private createUnimplementedException(): CapacitorException {\n    return new CapacitorException(\n      'This method is not implemented on web.',\n      ExceptionCode.Unimplemented,\n    );\n  }\n\n  private handleScannedBarcodes(barcodes: DetectedBarcode[]): void {\n    const result: BarcodesScannedEvent = {\n      barcodes: barcodes.map(barcode => ({\n        cornerPoints: [\n          [barcode.cornerPoints[0].x, barcode.cornerPoints[0].y],\n          [barcode.cornerPoints[1].x, barcode.cornerPoints[1].y],\n          [barcode.cornerPoints[2].x, barcode.cornerPoints[2].y],\n          [barcode.cornerPoints[3].x, barcode.cornerPoints[3].y],\n        ],\n        displayValue: barcode.rawValue,\n        rawValue: barcode.rawValue,\n        format: barcode.format.toUpperCase() as BarcodeFormat,\n        valueType: BarcodeValueType.Unknown,\n      })),\n    };\n    this.notifyListeners(this.eventBarcodesScanned, result);\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}