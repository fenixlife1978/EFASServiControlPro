(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[879],{5320:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(14294).A)("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]])},14294:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var r=a(12115);let n=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:u,...h}=e;return(0,r.createElement)("svg",{ref:t,...s,width:i,height:i,stroke:a,strokeWidth:l?24*Number(o)/Number(i):o,className:n("lucide",c),...h},[...u.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let a=(0,r.forwardRef)((a,s)=>{let{className:o,...l}=a;return(0,r.createElement)(i,{ref:s,iconNode:t,className:n("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),o),...l})});return a.displayName="".concat(e),a}},15039:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(14294).A)("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]])},32587:(e,t,a)=>{"use strict";var r,n,s;a.d(t,{$c:()=>r,E_:()=>c,F3:()=>l,I9:()=>i}),function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"}(r||(r={}));class i extends Error{constructor(e,t,a){super(e),this.message=e,this.code=t,this.data=a}}let o=(e=>e.Capacitor=(e=>{let t=e.CapacitorCustomPlatform||null,a=e.Capacitor||{},n=a.Plugins=a.Plugins||{},s=()=>null!==t?t.name:(e=>{var t,a;return(null==e?void 0:e.androidBridge)?"android":(null==(a=null==(t=null==e?void 0:e.webkit)?void 0:t.messageHandlers)?void 0:a.bridge)?"ios":"web"})(e),o=e=>{var t;return null==(t=a.PluginHeaders)?void 0:t.find(t=>t.name===e)},l=new Map;return a.convertFileSrc||(a.convertFileSrc=e=>e),a.getPlatform=s,a.handleError=t=>e.console.error(t),a.isNativePlatform=()=>"web"!==s(),a.isPluginAvailable=e=>{let t=l.get(e);return!!((null==t?void 0:t.platforms.has(s()))||o(e))},a.registerPlugin=(e,c={})=>{let d,u=l.get(e);if(u)return console.warn(`Capacitor plugin "${e}" already registered. Cannot register plugins twice.`),u.proxy;let h=s(),m=o(e),p=async()=>(!d&&h in c?d=d="function"==typeof c[h]?await c[h]():c[h]:null!==t&&!d&&"web"in c&&(d=d="function"==typeof c.web?await c.web():c.web),d),f=t=>{let n,s=(...s)=>{let o=p().then(o=>{let l=((t,n)=>{var s,o;if(m){let r=null==m?void 0:m.methods.find(e=>n===e.name);if(r)if("promise"===r.rtype)return t=>a.nativePromise(e,n.toString(),t);else return(t,r)=>a.nativeCallback(e,n.toString(),t,r);if(t)return null==(s=t[n])?void 0:s.bind(t)}else if(t)return null==(o=t[n])?void 0:o.bind(t);else throw new i(`"${e}" plugin is not implemented on ${h}`,r.Unimplemented)})(o,t);if(l){let e=l(...s);return n=null==e?void 0:e.remove,e}throw new i(`"${e}.${t}()" is not implemented on ${h}`,r.Unimplemented)});return"addListener"===t&&(o.remove=async()=>n()),o};return s.toString=()=>`${t.toString()}() { [capacitor code] }`,Object.defineProperty(s,"name",{value:t,writable:!1,configurable:!1}),s},g=f("addListener"),b=f("removeListener"),x=(e,t)=>{let a=g({eventName:e},t),r=async()=>{b({eventName:e,callbackId:await a},t)},n=new Promise(e=>a.then(()=>e({remove:r})));return n.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await r()},n},w=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return m?x:g;case"removeListener":return b;default:return f(t)}}});return n[e]=w,l.set(e,{name:e,proxy:w,platforms:new Set([...Object.keys(c),...m?[h]:[]])}),w},a.Exception=i,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a})(e))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==a.g?a.g:{}),l=o.registerPlugin;class c{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let a=!1;this.listeners[e]||(this.listeners[e]=[],a=!0),this.listeners[e].push(t);let r=this.windowListeners[e];return r&&!r.registered&&this.addWindowListener(r),a&&this.sendRetainedArgumentsForEvent(e),Promise.resolve({remove:async()=>this.removeListener(e,t)})}async removeAllListeners(){for(let e in this.listeners={},this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,a){let r=this.listeners[e];if(!r){if(a){let a=this.retainedEventArguments[e];a||(a=[]),a.push(t),this.retainedEventArguments[e]=a}return}r.forEach(e=>e(t))}hasListeners(e){var t;return!!(null==(t=this.listeners[e])?void 0:t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(e="not implemented"){return new o.Exception(e,r.Unimplemented)}unavailable(e="not available"){return new o.Exception(e,r.Unavailable)}async removeListener(e,t){let a=this.listeners[e];if(!a)return;let r=a.indexOf(t);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){let t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(t=>{this.notifyListeners(e,t)}))}}let d=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),u=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class h extends c{async getCookies(){let e=document.cookie,t={};return e.split(";").forEach(e=>{if(e.length<=0)return;let[a,r]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=u(a).trim(),r=u(r).trim(),t[a]=r}),t}async setCookie(e){try{let t=d(e.key),a=d(e.value),r=e.expires?`; expires=${e.expires.replace("expires=","")}`:"",n=(e.path||"/").replace("path=",""),s=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${a||""}${r}; path=${n}; ${s};`}catch(e){return Promise.reject(e)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(e){return Promise.reject(e)}}async clearCookies(){try{for(let e of document.cookie.split(";")||[])document.cookie=e.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}l("CapacitorCookies",{web:()=>new h});let m=async e=>new Promise((t,a)=>{let r=new FileReader;r.onload=()=>{let e=r.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},r.onerror=e=>a(e),r.readAsDataURL(e)});class p extends c{async request(e){let t,a,r=((e,t={})=>{let a=Object.assign({method:e.method||"GET",headers:e.headers},t),r=((e={})=>{let t=Object.keys(e);return Object.keys(e).map(e=>e.toLocaleLowerCase()).reduce((a,r,n)=>(a[r]=e[t[n]],a),{})})(e.headers)["content-type"]||"";if("string"==typeof e.data)a.body=e.data;else if(r.includes("application/x-www-form-urlencoded")){let t=new URLSearchParams;for(let[a,r]of Object.entries(e.data||{}))t.set(a,r);a.body=t.toString()}else if(r.includes("multipart/form-data")||e.data instanceof FormData){let t=new FormData;if(e.data instanceof FormData)e.data.forEach((e,a)=>{t.append(a,e)});else for(let a of Object.keys(e.data))t.append(a,e.data[a]);a.body=t;let r=new Headers(a.headers);r.delete("content-type"),a.headers=r}else(r.includes("application/json")||"object"==typeof e.data)&&(a.body=JSON.stringify(e.data));return a})(e,e.webFetchExtra),n=((e,t=!0)=>e?Object.entries(e).reduce((e,a)=>{let r,n,[s,i]=a;return Array.isArray(i)?(n="",i.forEach(e=>{r=t?encodeURIComponent(e):e,n+=`${s}=${r}&`}),n.slice(0,-1)):(r=t?encodeURIComponent(i):i,n=`${s}=${r}`),`${e}&${n}`},"").substr(1):null)(e.params,e.shouldEncodeUrlParams),s=n?`${e.url}?${n}`:e.url,i=await fetch(s,r),o=i.headers.get("content-type")||"",{responseType:l="text"}=i.ok?e:{};switch(o.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":a=await i.blob(),t=await m(a);break;case"json":t=await i.json();break;default:t=await i.text()}let c={};return i.headers.forEach((e,t)=>{c[t]=e}),{data:t,headers:c,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}l("CapacitorHttp",{web:()=>new p}),function(e){e.Dark="DARK",e.Light="LIGHT",e.Default="DEFAULT"}(n||(n={})),function(e){e.StatusBar="StatusBar",e.NavigationBar="NavigationBar"}(s||(s={}));class f extends c{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}l("SystemBars",{web:()=>new f})},45300:(e,t,a)=>{"use strict";a.d(t,{db:()=>c,j2:()=>l});var r=a(52078),n=a(59253),s=a(19708),i=a(58134);a(13328),a(34491);let o=(0,r.Dk)().length>0?(0,r.Sx)():(0,r.Wp)({apiKey:"AIzaSyACK79dDRclgjFMEUokqpskC1ezyvmO11k",authDomain:"studio-7637044995-2342d.firebaseapp.com",projectId:"studio-7637044995-2342d",storageBucket:"studio-7637044995-2342d.firebasestorage.app",messagingSenderId:"7637044995",appId:"1:7637044995:web:2c6b412952864386927958"}),l=(0,n.xI)(o),c=(0,s.aU)(o);(0,i.c7)(o)},54896:(e,t,a)=>{Promise.resolve().then(a.bind(a,67273))},57429:(e,t,a)=>{"use strict";var r,n,s,i,o,l,c,d,u;a.d(t,{Nn:()=>i,gH:()=>n}),function(e){e.Aztec="AZTEC",e.Codabar="CODABAR",e.Code39="CODE_39",e.Code93="CODE_93",e.Code128="CODE_128",e.DataMatrix="DATA_MATRIX",e.Ean8="EAN_8",e.Ean13="EAN_13",e.Itf="ITF",e.Pdf417="PDF_417",e.QrCode="QR_CODE",e.UpcA="UPC_A",e.UpcE="UPC_E"}(r||(r={})),function(e){e.CalendarEvent="CALENDAR_EVENT",e.ContactInfo="CONTACT_INFO",e.DriversLicense="DRIVERS_LICENSE",e.Email="EMAIL",e.Geo="GEO",e.Isbn="ISBN",e.Phone="PHONE",e.Product="PRODUCT",e.Sms="SMS",e.Text="TEXT",e.Url="URL",e.Wifi="WIFI",e.Unknown="UNKNOWN"}(n||(n={})),function(e){e[e["640x480"]=0]="640x480",e[e["1280x720"]=1]="1280x720",e[e["1920x1080"]=2]="1920x1080",e[e["3840x2160"]=3]="3840x2160"}(s||(s={})),function(e){e.Front="FRONT",e.Back="BACK"}(i||(i={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.PENDING=1]="PENDING",e[e.DOWNLOADING=2]="DOWNLOADING",e[e.CANCELED=3]="CANCELED",e[e.COMPLETED=4]="COMPLETED",e[e.FAILED=5]="FAILED",e[e.INSTALLING=6]="INSTALLING",e[e.DOWNLOAD_PAUSED=7]="DOWNLOAD_PAUSED"}(o||(o={})),function(e){e[e.HOME=0]="HOME",e[e.UNKNOWN=1]="UNKNOWN",e[e.WORK=2]="WORK"}(l||(l={})),function(e){e[e.HOME=0]="HOME",e[e.UNKNOWN=1]="UNKNOWN",e[e.WORK=2]="WORK"}(c||(c={})),function(e){e[e.FAX=0]="FAX",e[e.HOME=1]="HOME",e[e.MOBILE=2]="MOBILE",e[e.UNKNOWN=3]="UNKNOWN",e[e.WORK=4]="WORK"}(d||(d={})),function(e){e[e.OPEN=1]="OPEN",e[e.WEP=2]="WEP",e[e.WPA=3]="WPA"}(u||(u={}))},67273:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var r=a(95155),n=a(12115),s=a(19708),i=a(45300),o=a(32587);a(57429);let l=(0,o.F3)("BarcodeScanner",{web:()=>a.e(737).then(a.bind(a,34737)).then(e=>new e.BarcodeScannerWeb)});var c=a(92033),d=a(97965),u=a(5320);let h=(0,a(14294).A)("BellRing",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]]);var m=a(15039);let p=(0,o.F3)("DeviceControl"),f=[{id:1,nombre:"Matem\xe1ticas",icon:"\uD83E\uDDEE"},{id:2,nombre:"Diccionario",icon:"\uD83D\uDCD6"},{id:3,nombre:"Navegador",icon:"\uD83C\uDF10"},{id:4,nombre:"C\xe1mara",icon:"\uD83D\uDCF8"}];function g(){let[e,t]=(0,n.useState)(!1),[a,o]=(0,n.useState)(null),[g,b]=(0,n.useState)(!0),[x,w]=(0,n.useState)(!1),[v,y]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=localStorage.getItem("efas_device_id");e?N(e):b(!1)},[]);let N=e=>(t(!0),(0,s.aQ)((0,s.H9)(i.db,"dispositivos",e),e=>{if(e.exists()){let t=e.data();if(o(t),w(!0===t.comando_bloqueo),t.mensaje_alerta&&t.mensaje_alerta!==v&&y(t.mensaje_alerta),!0===t.comando_bloqueo)try{p.lockDevice()}catch(e){}}b(!1)})),E=async()=>{try{var e;if(!(null==(e=window.Capacitor)?void 0:e.isNativePlatform())){let e=prompt("Simulaci\xf3n: Pega el JSON del QR:");e&&A(e);return}let t=await l.requestPermissions();if("granted"!==t.camera)return alert("Permiso de c\xe1mara denegado");let{barcodes:a}=await l.scan();a.length>0&&A(a[0].displayValue)}catch(e){console.error(e),alert("Error al activar esc\xe1ner")}},A=async e=>{try{let t=JSON.parse(e);if("link_device"===t.action||"enroll"===t.action){b(!0);let e="DEV-".concat(Math.random().toString(36).substr(2,6).toUpperCase());await (0,s.BN)((0,s.H9)(i.db,"dispositivos",e),{id:e,InstitutoId:t.inst||t.InstitutoId,aulaId:t.aula||t.aulaId,status:"pending_name",alumno_asignado:"Esperando nombre...",comando_bloqueo:!1,mensaje_alerta:null,createdAt:(0,s.O5)(),lastConnection:(0,s.O5)()}),localStorage.setItem("efas_device_id",e),N(e)}}catch(e){alert("QR no v\xe1lido para EFAS"),b(!1)}};return g?(0,r.jsx)("div",{className:"min-h-screen bg-[#0a0c10] flex items-center justify-center text-white",children:(0,r.jsx)(c.A,{className:"animate-spin text-orange-500"})}):e?(0,r.jsxs)("div",{className:"min-h-screen bg-[#0a0c10] text-white p-8 font-sans",children:[(0,r.jsxs)("header",{className:"mb-12 flex justify-between items-center bg-[#11141d] p-6 rounded-[2.5rem] border border-white/5",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-xl font-black italic uppercase text-orange-500 leading-none",children:"EFAS"}),(0,r.jsx)("p",{className:"text-[8px] font-bold text-slate-500 uppercase",children:"ServControlPro"})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-[10px] font-black uppercase italic text-white",children:null==a?void 0:a.alumno_asignado}),(0,r.jsx)("p",{className:"text-[8px] font-bold text-green-500 uppercase",children:"Conectado"})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-6",children:f.map(e=>(0,r.jsxs)("button",{className:"flex flex-col items-center p-12 bg-[#11141d] border border-white/5 rounded-[3rem] active:scale-95 transition-all",children:[(0,r.jsx)("span",{className:"text-6xl mb-4",children:e.icon}),(0,r.jsx)("span",{className:"text-[10px] font-black uppercase text-slate-400 tracking-widest",children:e.nombre})]},e.id))}),v&&(0,r.jsx)("div",{className:"fixed inset-0 bg-slate-950/95 backdrop-blur-md z-50 flex items-center justify-center p-6",children:(0,r.jsxs)("div",{className:"bg-white p-10 rounded-[3rem] text-center max-w-sm border-b-8 border-orange-500",children:[(0,r.jsx)(h,{className:"w-12 h-12 text-orange-500 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-xl font-bold text-slate-900 mb-6 uppercase italic",children:v}),(0,r.jsx)("button",{onClick:()=>y(null),className:"bg-slate-900 text-white px-8 py-3 rounded-full font-black uppercase text-xs",children:"Entendido"})]})}),x&&(0,r.jsxs)("div",{className:"fixed inset-0 bg-red-600 z-[100] flex flex-col items-center justify-center text-white p-10",children:[(0,r.jsx)(m.A,{className:"w-24 h-24 mb-4 animate-pulse"}),(0,r.jsx)("h1",{className:"text-5xl font-black uppercase italic tracking-tighter",children:"Acceso Restringido"}),(0,r.jsx)("p",{className:"text-sm font-bold uppercase mt-4 opacity-80 text-center",children:"Este dispositivo ha sido bloqueado por el administrador"})]})]}):(0,r.jsx)("div",{className:"min-h-screen bg-[#0a0c10] flex items-center justify-center p-6 text-white",children:(0,r.jsxs)("div",{className:"max-w-md w-full text-center space-y-8",children:[(0,r.jsx)("div",{className:"bg-orange-500/10 p-8 rounded-[2.5rem] w-32 h-32 mx-auto flex items-center justify-center border border-orange-500/20 shadow-2xl",children:(0,r.jsx)(d.A,{className:"w-16 h-16 text-orange-500"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-4xl font-black italic uppercase tracking-tighter",children:["Efas ",(0,r.jsx)("span",{className:"text-orange-500",children:"Guardian"})]}),(0,r.jsx)("p",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-widest mt-2",children:"Dispositivo no vinculado"})]}),(0,r.jsxs)("button",{onClick:E,className:"w-full bg-orange-500 text-white py-6 rounded-[2rem] font-black uppercase italic flex items-center justify-center gap-3 shadow-lg shadow-orange-500/20 hover:scale-105 transition-all",children:[(0,r.jsx)(u.A,{})," Iniciar Vinculaci\xf3n"]})]})})}},92033:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(14294).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},97965:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(14294).A)("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]])}},e=>{e.O(0,[992,644,363,441,255,358],()=>e(e.s=54896)),_N_E=e.O()}]);