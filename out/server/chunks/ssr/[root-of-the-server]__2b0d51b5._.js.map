{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/switch.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,uBAAS,mNAAgB,CAG7B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,0KAAqB;QACpB,WAAW,IAAA,yHAAE,EACX,sXACA;QAED,GAAG,KAAK;QACT,KAAK;kBAEL,cAAA,8OAAC,2KAAsB;YACrB,WAAW,IAAA,yHAAE,EACX;;;;;;;;;;;AAKR,OAAO,WAAW,GAAG,0KAAqB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/hooks/use-toast.ts"],"sourcesContent":["\"use client\"\n\n// Inspired by react-hot-toast library\nimport * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 196, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/admin/config/GlobalControls.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { db } from '@/firebase';\nimport { doc, onSnapshot, updateDoc, setDoc } from 'firebase/firestore';\nimport { Power, ShieldAlert, GlobeLock, Zap, Loader2 } from 'lucide-react';\nimport { Switch } from '@/components/ui/switch'; // Asegúrate de tener el componente Switch de shadcn\nimport { useToast } from '@/hooks/use-toast';\n\nexport function GlobalControls({ institutionId }: { institutionId: string }) {\n  const [config, setConfig] = useState({\n    filterActive: true,\n    strictMode: false,\n    maintenanceMode: false\n  });\n  const [loading, setLoading] = useState(true);\n  const { toast } = useToast();\n\n  useEffect(() => {\n    const docRef = doc(db, `institutions/${institutionId}/config`, 'global_settings');\n    const unsubscribe = onSnapshot(docRef, (snapshot) => {\n      if (snapshot.exists()) {\n        setConfig(snapshot.data() as any);\n      } else {\n        setDoc(docRef, { filterActive: true, strictMode: false, maintenanceMode: false });\n      }\n      setLoading(false);\n    });\n    return () => unsubscribe();\n  }, [institutionId]);\n\n  const toggleSetting = async (key: string, value: boolean) => {\n    try {\n      const docRef = doc(db, `institutions/${institutionId}/config`, 'global_settings');\n      await updateDoc(docRef, { [key]: value });\n      toast({\n        title: \"Configuración Actualizada\",\n        description: `${key} ahora está ${value ? 'ACTIVADO' : 'DESACTIVADO'}`,\n      });\n    } catch (error) {\n      toast({ variant: \"destructive\", title: \"Error al actualizar\" });\n    }\n  };\n\n  if (loading) return <Loader2 className=\"w-6 h-6 animate-spin text-orange-500 mx-auto\" />;\n\n  return (\n    <div className=\"bg-[#11141d] border border-white/5 rounded-3xl p-8 shadow-xl\">\n      <div className=\"flex items-center gap-3 mb-8\">\n        <Zap className=\"text-orange-500 w-6 h-6\" />\n        <h2 className=\"text-xl font-black italic uppercase text-white\">Controles Maestros</h2>\n      </div>\n\n      <div className=\"space-y-6\">\n        {/* Interruptor de Filtro Global */}\n        <div className=\"flex items-center justify-between p-4 bg-white/5 rounded-2xl border border-white/5\">\n          <div className=\"flex gap-4 items-center\">\n            <div className={`p-3 rounded-xl ${config.filterActive ? 'bg-emerald-500/20 text-emerald-500' : 'bg-red-500/20 text-red-500'}`}>\n              <Power className=\"w-5 h-5\" />\n            </div>\n            <div>\n              <p className=\"text-sm font-black text-white uppercase italic\">Filtro de Contenido</p>\n              <p className=\"text-[10px] text-slate-500 font-bold uppercase\">Activa/Desactiva toda la protección</p>\n            </div>\n          </div>\n          <Switch \n            checked={config.filterActive} \n            onCheckedChange={(val) => toggleSetting('filterActive', val)} \n          />\n        </div>\n\n        {/* Interruptor de Modo Estricto */}\n        <div className=\"flex items-center justify-between p-4 bg-white/5 rounded-2xl border border-white/5\">\n          <div className=\"flex gap-4 items-center\">\n            <div className={`p-3 rounded-xl ${config.strictMode ? 'bg-orange-500/20 text-orange-500' : 'bg-slate-800 text-slate-500'}`}>\n              <ShieldAlert className=\"w-5 h-5\" />\n            </div>\n            <div>\n              <p className=\"text-sm font-black text-white uppercase italic\">Modo Estricto (Whitelisting)</p>\n              <p className=\"text-[10px] text-slate-500 font-bold uppercase\">Solo permite sitios autorizados</p>\n            </div>\n          </div>\n          <Switch \n            checked={config.strictMode} \n            onCheckedChange={(val) => toggleSetting('strictMode', val)} \n          />\n        </div>\n\n        {/* Bloqueo Total / Mantenimiento */}\n        <div className=\"flex items-center justify-between p-4 bg-white/5 rounded-2xl border border-white/5\">\n          <div className=\"flex gap-4 items-center\">\n            <div className={`p-3 rounded-xl ${config.maintenanceMode ? 'bg-red-600/20 text-red-600 animate-pulse' : 'bg-slate-800 text-slate-500'}`}>\n              <GlobeLock className=\"w-5 h-5\" />\n            </div>\n            <div>\n              <p className=\"text-sm font-black text-white uppercase italic\">Bloqueo de Navegación</p>\n              <p className=\"text-[10px] text-slate-500 font-bold uppercase\">Cierra el acceso a internet totalmente</p>\n            </div>\n          </div>\n          <Switch \n            checked={config.maintenanceMode} \n            onCheckedChange={(val) => toggleSetting('maintenanceMode', val)} \n          />\n        </div>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 510, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/admin/monitoring/WebHistoryModal.tsx"],"sourcesContent":["'use client';\nimport React, { useEffect, useState } from 'react';\nimport { db } from '@/firebase/config';\nimport { collection, query, where, orderBy, limit, onSnapshot } from 'firebase/firestore';\nimport { X, Globe, Clock, ExternalLink, ShieldAlert } from 'lucide-react';\n\ninterface WebHistory {\n  id: string;\n  url: string;\n  timestamp: any;\n}\n\ninterface WebHistoryModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  tabletId: string;\n  alumnoNombre: string;\n}\n\nexport function WebHistoryModal({ isOpen, onClose, tabletId, alumnoNombre }: WebHistoryModalProps) {\n  const [history, setHistory] = useState<WebHistory[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (!isOpen || !tabletId) return;\n\n    setLoading(true);\n    // Buscamos en la colección 'web_history' filtrando por la tablet específica\n    const q = query(\n      collection(db, 'web_history'),\n      where('tabletId', '==', tabletId),\n      orderBy('timestamp', 'desc'),\n      limit(20)\n    );\n\n    const unsubscribe = onSnapshot(q, (snapshot) => {\n      const docs = snapshot.docs.map(doc => ({\n        id: doc.id,\n        ...doc.data()\n      })) as WebHistory[];\n      setHistory(docs);\n      setLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, [isOpen, tabletId]);\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm\">\n      <div className=\"bg-[#1a1d23] border border-white/10 w-full max-w-2xl rounded-2xl shadow-2xl overflow-hidden\">\n        {/* Header */}\n        <div className=\"p-6 border-b border-white/10 flex items-center justify-between bg-gradient-to-r from-orange-500/10 to-transparent\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-10 h-10 rounded-full bg-orange-500/20 flex items-center justify-center\">\n              <Globe className=\"text-orange-500 w-5 h-5\" />\n            </div>\n            <div>\n              <h3 className=\"text-white font-bold text-lg leading-tight\">Historial de Navegación</h3>\n              <p className=\"text-slate-400 text-xs uppercase tracking-wider font-semibold\">Alumno: {alumnoNombre}</p>\n            </div>\n          </div>\n          <button onClick={onClose} className=\"p-2 hover:bg-white/10 rounded-full transition-colors text-slate-400 hover:text-white\">\n            <X className=\"w-6 h-6\" />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 max-h-[60vh] overflow-y-auto\">\n          {loading ? (\n            <div className=\"flex flex-col items-center justify-center py-12 gap-3\">\n              <div className=\"w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full animate-spin\"></div>\n              <p className=\"text-slate-500 text-sm\">Consultando Centinela...</p>\n            </div>\n          ) : history.length > 0 ? (\n            <div className=\"space-y-3\">\n              {history.map((item) => (\n                <div key={item.id} className=\"group p-4 rounded-xl bg-white/5 border border-white/5 hover:border-orange-500/30 hover:bg-orange-500/5 transition-all flex items-center justify-between\">\n                  <div className=\"flex items-center gap-4 overflow-hidden\">\n                    <div className=\"p-2 rounded-lg bg-slate-800 text-slate-400 group-hover:text-orange-500 group-hover:bg-orange-500/10 transition-colors\">\n                      <Clock className=\"w-4 h-4\" />\n                    </div>\n                    <div className=\"overflow-hidden\">\n                      <p className=\"text-sm text-slate-200 font-medium truncate group-hover:text-white\">{item.url}</p>\n                      <p className=\"text-[10px] text-slate-500 font-mono\">\n                        {item.timestamp?.toDate().toLocaleString() || 'Fecha no disponible'}\n                      </p>\n                    </div>\n                  </div>\n                  <a href={item.url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"p-2 text-slate-500 hover:text-orange-500 opacity-0 group-hover:opacity-100 transition-all\">\n                    <ExternalLink className=\"w-4 h-4\" />\n                  </a>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"flex flex-col items-center justify-center py-12 text-center\">\n              <ShieldAlert className=\"w-12 h-12 text-slate-700 mb-4\" />\n              <p className=\"text-slate-400 font-medium\">No se detectaron registros recientes.</p>\n              <p className=\"text-slate-600 text-xs mt-1\">El sistema Centinela no ha reportado actividad para este dispositivo.</p>\n            </div>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"p-4 bg-black/20 border-t border-white/5 text-center\">\n          <p className=\"text-[10px] text-slate-500 uppercase tracking-[0.2em]\">EDUControlPro Sistema de Control Parental Educativo - Monitoreo en Tiempo Real</p>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAJA;;;;;;AAmBO,SAAS,gBAAgB,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,YAAY,EAAwB;IAC/F,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAe,EAAE;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,UAAU,CAAC,UAAU;QAE1B,WAAW;QACX,4EAA4E;QAC5E,MAAM,IAAI,IAAA,0KAAK,EACb,IAAA,+KAAU,EAAC,+HAAE,EAAE,gBACf,IAAA,0KAAK,EAAC,YAAY,MAAM,WACxB,IAAA,4KAAO,EAAC,aAAa,SACrB,IAAA,0KAAK,EAAC;QAGR,MAAM,cAAc,IAAA,+KAAU,EAAC,GAAG,CAAC;YACjC,MAAM,OAAO,SAAS,IAAI,CAAC,GAAG,CAAC,CAAA,MAAO,CAAC;oBACrC,IAAI,IAAI,EAAE;oBACV,GAAG,IAAI,IAAI,EAAE;gBACf,CAAC;YACD,WAAW;YACX,WAAW;QACb;QAEA,OAAO,IAAM;IACf,GAAG;QAAC;QAAQ;KAAS;IAErB,IAAI,CAAC,QAAQ,OAAO;IAEpB,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BAEb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;8CACb,cAAA,8OAAC,6MAAK;wCAAC,WAAU;;;;;;;;;;;8CAEnB,8OAAC;;sDACC,8OAAC;4CAAG,WAAU;sDAA6C;;;;;;sDAC3D,8OAAC;4CAAE,WAAU;;gDAAgE;gDAAS;;;;;;;;;;;;;;;;;;;sCAG1F,8OAAC;4BAAO,SAAS;4BAAS,WAAU;sCAClC,cAAA,8OAAC,iMAAC;gCAAC,WAAU;;;;;;;;;;;;;;;;;8BAKjB,8OAAC;oBAAI,WAAU;8BACZ,wBACC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;;;;;;0CACf,8OAAC;gCAAE,WAAU;0CAAyB;;;;;;;;;;;+BAEtC,QAAQ,MAAM,GAAG,kBACnB,8OAAC;wBAAI,WAAU;kCACZ,QAAQ,GAAG,CAAC,CAAC,qBACZ,8OAAC;gCAAkB,WAAU;;kDAC3B,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAI,WAAU;0DACb,cAAA,8OAAC,6MAAK;oDAAC,WAAU;;;;;;;;;;;0DAEnB,8OAAC;gDAAI,WAAU;;kEACb,8OAAC;wDAAE,WAAU;kEAAsE,KAAK,GAAG;;;;;;kEAC3F,8OAAC;wDAAE,WAAU;kEACV,KAAK,SAAS,EAAE,SAAS,oBAAoB;;;;;;;;;;;;;;;;;;kDAIpD,8OAAC;wCAAE,MAAM,KAAK,GAAG;wCAAE,QAAO;wCAAS,KAAI;wCAAsB,WAAU;kDACrE,cAAA,8OAAC,sOAAY;4CAAC,WAAU;;;;;;;;;;;;+BAblB,KAAK,EAAE;;;;;;;;;6CAmBrB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,mOAAW;gCAAC,WAAU;;;;;;0CACvB,8OAAC;gCAAE,WAAU;0CAA6B;;;;;;0CAC1C,8OAAC;gCAAE,WAAU;0CAA8B;;;;;;;;;;;;;;;;;8BAMjD,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAE,WAAU;kCAAwD;;;;;;;;;;;;;;;;;;;;;;AAK/E","debugId":null}},
    {"offset": {"line": 810, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/admin/config/SecurityRules.tsx"],"sourcesContent":["'use client';\nimport React, { useState, useEffect } from 'react';\nimport { db } from '@/firebase/config';\nimport { doc, onSnapshot, updateDoc, arrayUnion, arrayRemove, serverTimestamp, collection, query, where, getDocs, limit } from 'firebase/firestore';\nimport { \n  ShieldCheck, Globe, Lock, Unlock, Database, Download, \n  AlertTriangle, CheckCircle2, Plus, Trash2, FileText, ShieldAlert, RefreshCw \n} from 'lucide-react';\nimport jsPDF from 'jspdf';\nimport autoTable from 'jspdf-autotable';\n\ninterface SecurityRulesProps {\n  institutionId: string;\n}\n\nexport const SecurityRules = ({ institutionId }: SecurityRulesProps) => {\n  const [loading, setLoading] = useState(false);\n  const [data, setData] = useState<any>(null);\n  const [newUrl, setNewUrl] = useState('');\n  const [filterType, setFilterType] = useState<'blacklist' | 'whitelist'>('blacklist');\n  const [incidencias, setIncidencias] = useState<any[]>([]);\n  const [refreshing, setRefreshing] = useState(false);\n\n  useEffect(() => {\n    if (!institutionId) return;\n    return onSnapshot(doc(db, \"institutions\", institutionId), (d) => {\n      if (d.exists()) setData(d.data());\n    });\n  }, [institutionId]);\n\n  const fetchIncidencias = async () => {\n    setRefreshing(true);\n    try {\n      const q = query(collection(db, \"incidencias\"), where(\"InstitutoId\", \"==\", institutionId), limit(20));\n      const querySnapshot = await getDocs(q);\n      const docs = querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n      setIncidencias(docs);\n    } catch (e) { \n      console.error(e);\n      setIncidencias([\n        { alumno: \"Simulación: Juan Pérez\", tablet: \"TAB-001\", fecha: \"2026-02-20\", hora: \"14:00\", url: \"ejemplo-bloqueado.com\" }\n      ]);\n    }\n    setTimeout(() => setRefreshing(false), 800);\n  };\n\n  const generatePDF = (tipo: 'seguridad' | 'incidencias') => {\n    const doc = new jsPDF();\n    const isInc = tipo === 'incidencias';\n    \n    doc.setFillColor(15, 17, 23);\n    doc.rect(0, 0, 210, 40, 'F');\n    doc.setTextColor(255, 255, 255);\n    doc.setFontSize(22);\n    doc.setFont(\"helvetica\", \"bold\");\n    doc.text(\"EDU SERVICONTROLPRO\", 15, 20);\n    doc.setFontSize(9);\n    doc.setFont(\"helvetica\", \"italic\");\n    doc.text(isInc ? \"REPORTE DETALLADO DE INCIDENCIAS\" : \"REPORTE OFICIAL DE CUMPLIMIENTO CIPA\", 15, 28);\n    \n    doc.setTextColor(40, 40, 40);\n    doc.setFontSize(10);\n    const instText = `Institución: ${data?.nombre || institutionId}`;\n    doc.text(instText, 15, 50);\n    \n    // Sello de Sede Protegida Verde\n    doc.setTextColor(34, 197, 94);\n    doc.setFontSize(8);\n    doc.text(' [ SEDE PROTEGIDA - VALIDADO POR EDU ]', 15 + doc.getTextWidth(instText), 50);\n\n    autoTable(doc, {\n      startY: 65,\n      head: isInc ? [['ALUMNO', 'DISPOSITIVO', 'FECHA', 'HORA', 'URL DETECTADA']] : [['TIPO', 'CRITERIO / URL', 'SITUACIÓN']],\n      body: isInc ? incidencias.map(i => [i.alumno, i.tablet, i.fecha, i.hora, i.url]) : (data?.blacklist || []).map((u: string) => ['BLACKLIST', u, 'ACTIVO']),\n      headStyles: { fillColor: isInc ? [234, 88, 12] : [15, 17, 23] }\n    });\n    doc.save(`EDU_Reporte_${tipo}.pdf`);\n  };\n\n  const packs = {\n    cipa_strict: {\n      name: \"CIPA Compliance Pack (USA)\",\n      desc: \"Bloqueo estricto de pornografía, contenido obsceno y dañino para menores.\",\n      urls: [\"porn.com\", \"xvideos.com\", \"gambling.com\", \"bet365.com\", \"chatroulette.com\"]\n    },\n    social_blackout: {\n      name: \"Focus Mode: Social Media\",\n      desc: \"Restringe acceso a redes sociales durante horario académico.\",\n      urls: [\"facebook.com\", \"instagram.com\", \"tiktok.com\", \"twitter.com\", \"x.com\"]\n    }\n  };\n\n  const importPack = async (packUrls: string[], packName: string) => {\n    setLoading(true);\n    try {\n      await updateDoc(doc(db, \"institutions\", institutionId), {\n        blacklist: arrayUnion(...packUrls),\n        lastSecurityUpdate: serverTimestamp()\n      });\n    } catch (e) { console.error(e); }\n    setLoading(false);\n  };\n\n  const handleAddUrl = async () => {\n    if (!newUrl) return;\n    await updateDoc(doc(db, \"institutions\", institutionId), {\n      [filterType]: arrayUnion(newUrl.toLowerCase().trim()),\n      lastSecurityUpdate: serverTimestamp()\n    });\n    setNewUrl('');\n  };\n\n  const handleRemoveUrl = async (url: string, type: 'blacklist' | 'whitelist') => {\n    await updateDoc(doc(db, \"institutions\", institutionId), { [type]: arrayRemove(url) });\n  };\n\n  return (\n    <div className=\"space-y-8 animate-in fade-in duration-700 pb-20\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h2 className=\"text-3xl font-black italic uppercase text-white tracking-tighter\">Security <span className=\"text-orange-500\">Center</span></h2>\n          <p className=\"text-[9px] font-bold text-slate-500 uppercase tracking-widest italic\">Filtrado de Contenido Nivel Gubernamental</p>\n        </div>\n        <div className=\"bg-slate-900/50 border border-slate-800 p-4 rounded-2xl flex items-center gap-3\">\n          <Globe className=\"text-blue-500\" size={18} />\n          <p className=\"text-[10px] font-black text-white uppercase italic\">Filtrado Activo</p>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n        {/* PANEL IZQUIERDO: PACKS */}\n        <div className=\"bg-[#0f1117] p-8 rounded-[2.5rem] border border-slate-800 shadow-2xl relative overflow-hidden group\">\n          <div className=\"flex items-center gap-2 text-orange-500 mb-4\">\n            <Download size={16} />\n            <span className=\"text-[10px] font-black uppercase tracking-widest\">Importar Protocolos</span>\n          </div>\n          <h3 className=\"text-xl font-black italic uppercase text-white mb-2\">Packs Globales</h3>\n          <div className=\"space-y-3 mt-6\">\n            {Object.entries(packs).map(([key, pack]) => (\n              <button key={key} onClick={() => importPack(pack.urls, pack.name)} className=\"w-full flex items-center justify-between p-4 bg-slate-900 border border-slate-800 rounded-2xl hover:border-orange-500 transition-all group/btn\">\n                <div className=\"text-left\">\n                  <p className=\"text-[9px] font-black text-white uppercase italic\">{pack.name}</p>\n                  <p className=\"text-[7px] font-bold text-slate-600 uppercase mt-1\">{pack.desc}</p>\n                </div>\n                <Plus size={16} />\n              </button>\n            ))}\n          </div>\n        </div>\n\n        {/* PANEL DERECHO: ESTADO Y CONTADOR SUPERIOR */}\n        <div className=\"bg-[#0f1117] p-8 rounded-[2.5rem] border border-slate-800\">\n          <div className=\"flex items-center gap-2 text-blue-500 mb-4\">\n            <ShieldCheck size={16} />\n            <span className=\"text-[10px] font-black uppercase tracking-widest\">Estado de Reglas</span>\n          </div>\n          \n          {/* CONTADOR SUPERIOR (IMPACTO CIPA) */}\n          <div className=\"mb-6 p-6 bg-orange-500/5 border border-orange-500/10 rounded-[2rem] flex items-center justify-between group\">\n             <div>\n                <p className=\"text-[7px] font-black text-orange-500 uppercase tracking-[0.3em] mb-1\">Impacto de Protección CIPA</p>\n                <p className=\"text-2xl font-black text-white italic tracking-tighter uppercase leading-none\">\n                  {data?.blacklist?.length || 0}\n                  <span className=\"text-orange-500 text-xs ml-2\">Amenazas Bloqueadas</span>\n                </p>\n             </div>\n             <ShieldCheck className=\"text-orange-500 animate-pulse\" size={24} />\n          </div>\n\n          <div className=\"space-y-4\">\n            <div className=\"flex justify-between items-center p-5 bg-black/30 rounded-2xl border border-slate-800/50\">\n               <div className=\"flex items-center gap-3\"><Lock className=\"text-red-500\" size={16}/><span className=\"text-[10px] font-black text-white uppercase italic\">Lista Negra</span></div>\n               <span className=\"text-[10px] font-mono text-slate-500\">TOTAL: {data?.blacklist?.length || 0}</span>\n            </div>\n            <div className=\"flex justify-between items-center p-5 bg-black/30 rounded-2xl border border-slate-800/50\">\n               <div className=\"flex items-center gap-3\"><Unlock className=\"text-green-500\" size={16}/><span className=\"text-[10px] font-black text-white uppercase italic\">Lista Blanca</span></div>\n               <span className=\"text-[10px] font-mono text-slate-500\">TOTAL: {data?.whitelist?.length || 0}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <hr className=\"border-slate-800 my-10\" />\n\n      {/* SECCIÓN BAJA: GESTIÓN Y LOGS */}\n      <div className=\"grid grid-cols-12 gap-8\">\n        <div className=\"col-span-12 lg:col-span-8 space-y-6\">\n          <div className=\"bg-[#0f1117] p-8 rounded-[2.5rem] border border-slate-800 shadow-xl\">\n            <h3 className=\"text-xs font-black text-white uppercase mb-6 flex items-center gap-2 italic\">\n              <Plus size={14} className=\"text-orange-500\"/> Gestión Manual de Filtros\n            </h3>\n            <div className=\"flex gap-4 mb-8\">\n              <select className=\"bg-black border border-slate-800 p-4 rounded-xl text-[9px] font-black text-orange-500 uppercase outline-none\" value={filterType} onChange={(e: any) => setFilterType(e.target.value)}>\n                <option value=\"blacklist\">Blacklist</option>\n                <option value=\"whitelist\">Whitelist</option>\n              </select>\n              <input className=\"flex-1 bg-black border border-slate-800 p-4 rounded-xl text-[10px] font-bold text-white uppercase outline-none focus:border-orange-500\" placeholder=\"Añadir url o palabra clave...\" value={newUrl} onChange={e => setNewUrl(e.target.value)} onKeyPress={e => e.key === 'Enter' && handleAddUrl()} />\n              <button onClick={handleAddUrl} className=\"bg-orange-500 px-6 rounded-xl text-white font-black\"><Plus size={18}/></button>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-6 h-64\">\n              <div className=\"overflow-y-auto space-y-2 pr-2 custom-scrollbar\">\n                <p className=\"text-[8px] font-black text-red-500 uppercase sticky top-0 bg-[#0f1117] pb-2\">Blacklist Actual</p>\n                {data?.blacklist?.map((url: string) => (\n                  <div key={url} className=\"flex justify-between items-center bg-black/40 p-3 rounded-lg border border-slate-800\">\n                    <span className=\"text-[9px] font-mono text-slate-400 truncate\">{url}</span>\n                    <button onClick={() => handleRemoveUrl(url, 'blacklist')} className=\"text-slate-600 hover:text-red-500 transition-colors\"><Trash2 size={12}/></button>\n                  </div>\n                ))}\n              </div>\n              <div className=\"overflow-y-auto space-y-2 pr-2 custom-scrollbar\">\n                <p className=\"text-[8px] font-black text-green-500 uppercase sticky top-0 bg-[#0f1117] pb-2\">Whitelist Actual</p>\n                {data?.whitelist?.map((url: string) => (\n                  <div key={url} className=\"flex justify-between items-center bg-black/40 p-3 rounded-lg border border-slate-800\">\n                    <span className=\"text-[9px] font-mono text-slate-400 truncate\">{url}</span>\n                    <button onClick={() => handleRemoveUrl(url, 'whitelist')} className=\"text-slate-600 hover:text-red-500 transition-colors\"><Trash2 size={12}/></button>\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n\n          <div className=\"bg-[#0f1117] p-8 rounded-[2.5rem] border border-slate-800\">\n             <div className=\"flex justify-between items-center mb-6\">\n                <h3 className=\"text-xs font-black text-white uppercase italic flex items-center gap-2\"><ShieldAlert className=\"text-orange-500\" size={16}/> Logs de Incidencias</h3>\n                <div className=\"flex gap-2\">\n                  <button onClick={fetchIncidencias} className={`p-2 rounded-lg bg-slate-900 border border-slate-800 text-orange-500 transition-all ${refreshing ? 'animate-spin' : ''}`}><RefreshCw size={14} /></button>\n                  <button onClick={() => generatePDF('incidencias')} className=\"text-[8px] font-black text-slate-500 hover:text-white uppercase border border-slate-800 px-3 rounded-lg\">Exportar Logs</button>\n                </div>\n             </div>\n             <div className=\"space-y-2\">\n                {incidencias.length > 0 ? incidencias.map((inc, idx) => (\n                  <div key={idx} className=\"grid grid-cols-5 gap-4 p-4 bg-black/40 rounded-xl border border-slate-800/50 text-[8px] font-bold uppercase italic text-slate-400\">\n                    <span className=\"text-white tracking-tighter\">{inc.alumno}</span>\n                    <span className=\"text-orange-500/80\">{inc.tablet}</span>\n                    <span className=\"text-slate-600\">{inc.fecha}</span>\n                    <span className=\"text-slate-600\">{inc.hora}</span>\n                    <span className=\"text-red-500/70 truncate\">{inc.url}</span>\n                  </div>\n                )) : (\n                  <div className=\"text-center py-10 text-[9px] font-black text-slate-600 uppercase tracking-[0.2em]\">Pulsa el icono para actualizar incidencias</div>\n                )}\n             </div>\n          </div>\n        </div>\n\n        <div className=\"col-span-12 lg:col-span-4 space-y-6\">\n          <div className=\"bg-[#0f1117] p-8 rounded-[2.5rem] border border-slate-800 space-y-6\">\n            <div className=\"text-center\">\n              <FileText className=\"text-orange-500 mx-auto mb-4\" size={32} />\n              <h4 className=\"text-[11px] font-black text-white uppercase italic\">Reporte de Protección</h4>\n            </div>\n\n            {/* CONTADOR INFERIOR (PROTECCIÓN ACTIVA) */}\n            <div className=\"p-6 bg-green-500/5 border border-green-500/10 rounded-2xl\">\n                <p className=\"text-[7px] font-black text-green-500 uppercase tracking-[0.2em] mb-1\">Estado de Seguridad</p>\n                <p className=\"text-xl font-black text-white italic\">{data?.blacklist?.length || 0} <span className=\"text-green-500 text-[10px]\">URLs Protegidas</span></p>\n            </div>\n\n            <button onClick={() => generatePDF('seguridad')} className=\"w-full bg-white text-black font-black py-4 rounded-xl text-[10px] uppercase italic hover:bg-orange-500 hover:text-white transition-all shadow-lg\">\n              Descargar PDF Profesional\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1792, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/dashboard/InstitutionView.tsx"],"sourcesContent":["'use client';\nimport React, { useState, useEffect } from 'react';\nimport { db, auth } from '@/firebase/config';\nimport { \n  collection, query, onSnapshot, where, addDoc, serverTimestamp, \n  doc, getDoc, updateDoc, deleteDoc \n} from 'firebase/firestore';\nimport { useInstitution } from '@/app/(admin)/dashboard/institution-context';\nimport { \n  ShieldAlert, Radio, Users, LogOut, Lock, Search, MessageSquare, Send,\n  Plus, DoorOpen, Activity, Monitor, Globe, ChevronRight, Tablet, User, \n  ArrowLeft, Settings, Trash2, Zap, Save, Building2, Key, Info, Edit3, Link2, Check, X, HardDrive, Smartphone, MapPin, ShieldCheck\n} from 'lucide-react';\nimport { signOut } from 'firebase/auth';\nimport { GlobalControls } from '@/components/admin/config/GlobalControls';\nimport { WebHistoryModal } from '@/components/admin/monitoring/WebHistoryModal';\nimport { SecurityRules } from '@/components/admin/config/SecurityRules';\n\nexport default function InstitutionView() {\n  const { institutionId, setInstitutionId } = useInstitution();\n  const [institutionName, setInstitutionName] = useState('Cargando...');\n  const [instData, setInstData] = useState({ direccion: '', telefono: '' });\n  const [activeSection, setActiveSection] = useState<'dashboard' | 'monitoring' | 'users' | 'settings' | 'security'>('dashboard');\n  const [historyModal, setHistoryModal] = useState({ isOpen: false, tabletId: '', alumnoNombre: '' });\n  const [messageModal, setMessageModal] = useState({ isOpen: false, tabletId: '', alumnoNombre: '', text: '' });\n  const [aulas, setAulas] = useState<any[]>([]);\n  const [tablets, setTablets] = useState<any[]>([]);\n  const [selectedAula, setSelectedAula] = useState<any>(null);\n  const [alumnos, setAlumnos] = useState<any[]>([]);\n  const [allAlumnos, setAllAlumnos] = useState<any[]>([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [showModal, setShowModal] = useState(false);\n  const [newAula, setNewAula] = useState({ nombre_completo: '', seccion: '' });\n  const [editingAula, setEditingAula] = useState<any>(null);\n  const [editingUser, setEditingUser] = useState<any>(null);\n  const [activeUrlRequest, setActiveUrlRequest] = useState<string | null>(null);\n  const [isSaving, setIsSaving] = useState(false);\n\n  const inputStyle = \"w-full bg-slate-900 border border-slate-800 p-4 rounded-xl text-white font-bold text-xs uppercase outline-none focus:border-orange-500 transition-all\";\n\n  useEffect(() => {\n    if (!institutionId) return;\n    const fetchInstData = async () => {\n      const docRef = doc(db, \"institutions\", institutionId);\n      const docSnap = await getDoc(docRef);\n      if (docSnap.exists()) {\n        const data = docSnap.data();\n        setInstitutionName(data.nombre);\n        setInstData({ direccion: data.direccion || '', telefono: data.telefono || '' });\n      }\n    };\n    fetchInstData();\n  }, [institutionId]);\n\n  useEffect(() => {\n    if (!institutionId) return;\n    const unsubAulas = onSnapshot(query(collection(db, `institutions/${institutionId}/Aulas`)), (s) => {\n      setAulas(s.docs.map(d => ({ id: d.id, ...d.data() })));\n    });\n    const unsubTablets = onSnapshot(query(collection(db, \"dispositivos\"), where(\"InstitutoId\", \"==\", institutionId)), (s) => {\n      setTablets(s.docs.map(d => ({ id: d.id, ...d.data() })));\n    });\n    const unsubAllAlumnos = onSnapshot(query(collection(db, \"usuarios\"), where(\"InstitutoId\", \"==\", institutionId), where(\"role\", \"==\", \"estudiante\")), (s) => {\n      setAllAlumnos(s.docs.map(d => ({ id: d.id, ...d.data() })));\n    });\n    return () => { unsubAulas(); unsubTablets(); unsubAllAlumnos(); };\n  }, [institutionId]);\n\n  useEffect(() => {\n    if (!selectedAula || !institutionId) { setAlumnos([]); return; }\n    const q = query(collection(db, \"usuarios\"), \n              where(\"InstitutoId\", \"==\", institutionId), \n              where(\"aulaId\", \"==\", selectedAula.id),\n              where(\"role\", \"==\", \"estudiante\"));\n    return onSnapshot(q, (s) => {\n      setAlumnos(s.docs.map(d => ({ id: d.id, ...d.data() })));\n    });\n  }, [selectedAula, institutionId]);\n\n  const handleUpdateInstitution = async () => {\n    if (!institutionId) return;\n    setIsSaving(true);\n    try {\n      await updateDoc(doc(db, \"institutions\", institutionId), {\n        nombre: institutionName,\n        direccion: instData.direccion,\n        telefono: instData.telefono,\n        lastUpdated: serverTimestamp()\n      });\n      alert(\"✅ Datos de la Sede actualizados.\");\n    } catch (e) { console.error(e); }\n    setIsSaving(false);\n  };\n\n  const handleSendMessage = async () => {\n    if (!messageModal.tabletId || !messageModal.text.trim()) return;\n    setIsSaving(true);\n    try {\n      await updateDoc(doc(db, \"dispositivos\", messageModal.tabletId), {\n        pending_message: messageModal.text,\n        message_timestamp: serverTimestamp(),\n        message_sender: \"Dirección Institucional\"\n      });\n      setMessageModal({ ...messageModal, isOpen: false, text: '' });\n    } catch (e) { console.error(e); }\n    setIsSaving(false);\n  };\n\n  const handleSaveAula = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newAula.nombre_completo || !newAula.seccion) return;\n    try {\n      if (editingAula) {\n        await updateDoc(doc(db, `institutions/${institutionId}/Aulas`, editingAula.id), { ...newAula, lastUpdated: serverTimestamp() });\n      } else {\n        await addDoc(collection(db, `institutions/${institutionId}/Aulas`), { ...newAula, status: 'published', createdAt: serverTimestamp(), InstitutoId: institutionId });\n      }\n      setShowModal(false); setEditingAula(null); setNewAula({ nombre_completo: '', seccion: '' });\n    } catch (e) { console.error(e); }\n  };\n\n  const handleDeleteAula = async (e: React.MouseEvent, aulaId: string) => {\n    e.stopPropagation();\n    if (!confirm('¿ELIMINAR ESTA AULA PERMANENTEMENTE?')) return;\n    try { await deleteDoc(doc(db, `institutions/${institutionId}/Aulas`, aulaId)); } catch (e) { console.error(e); }\n  };\n\n  const handleUpdateUser = async () => {\n    if (!editingUser) return;\n    try {\n      await updateDoc(doc(db, \"usuarios\", editingUser.id), {\n        nombre: editingUser.nombre,\n        aulaId: editingUser.aulaId,\n        updatedAt: serverTimestamp()\n      });\n      setEditingUser(null);\n      alert(\"✅ Usuario actualizado correctamente.\");\n    } catch (e) { console.error(e); }\n  };\n\n  const handleDeleteUser = async (userId: string, tabletId?: string) => {\n    if (!confirm(\"¿ELIMINAR ESTE ALUMNO? SE DESVINCULARÁ LA TABLET AUTOMÁTICAMENTE.\")) return;\n    try {\n      if (tabletId) {\n        await updateDoc(doc(db, \"dispositivos\", tabletId), {\n          alumno_asignado: \"\",\n          aulaId: \"\",\n          status: \"available\",\n          last_url: \"Desvinculado por Dirección\"\n        });\n      }\n      await deleteDoc(doc(db, \"usuarios\", userId));\n      alert(\"✅ Alumno eliminado y Hardware liberado.\");\n    } catch (e) { console.error(e); }\n  };\n\n  const filteredUsers = allAlumnos.filter(a => \n    a.nombre.toLowerCase().includes(searchTerm.toLowerCase()) || \n    (a.tabletId && a.tabletId.toLowerCase().includes(searchTerm.toLowerCase()))\n  );\n\n  return (\n    <div className=\"min-h-screen bg-[#0a0c10] text-slate-300 font-sans\">\n      <nav className=\"fixed left-0 top-0 h-full w-20 bg-[#0f1117] border-r border-slate-800/50 flex flex-col items-center py-8 gap-8 z-50\">\n        <div className=\"bg-orange-500 p-3 rounded-2xl shadow-lg shadow-orange-500/20\"><ShieldAlert className=\"text-white w-6 h-6\" /></div>\n        <div className=\"flex-1 flex flex-col gap-6 pt-10\">\n          <button title=\"Tablero de Control\" onClick={() => { setActiveSection('dashboard'); setSelectedAula(null); }} className={`p-3 rounded-xl transition-all ${activeSection === 'dashboard' ? 'text-orange-500 bg-orange-500/10' : 'text-slate-600 hover:text-white'}`}><Activity className=\"w-5 h-5\" /></button>\n          <button title=\"U.S. Security Center\" onClick={() => setActiveSection('security')} className={`p-3 rounded-xl transition-all ${activeSection === 'security' ? 'text-orange-500 bg-orange-500/10' : 'text-slate-600 hover:text-white'}`}><ShieldCheck className=\"w-5 h-5\" /></button>\n          <button title=\"Directorio Global\" onClick={() => setActiveSection('users')} className={`p-3 rounded-xl transition-all ${activeSection === 'users' ? 'text-orange-500 bg-orange-500/10' : 'text-slate-600 hover:text-white'}`}><Users className=\"w-5 h-5\" /></button>\n          <button title=\"Configuración de Sede\" onClick={() => setActiveSection('settings')} className={`p-3 rounded-xl transition-all ${activeSection === 'settings' ? 'text-orange-500 bg-orange-500/10' : 'text-slate-600 hover:text-white'}`}><Settings className=\"w-5 h-5\" /></button>\n        </div>\n        <button title=\"Cerrar Sesión\" onClick={() => signOut(auth)} className=\"p-3 text-slate-600 hover:text-red-500 transition-colors\"><LogOut className=\"w-5 h-5\" /></button>\n      </nav>\n\n      <main className=\"pl-20\">\n        <header className=\"sticky top-0 z-40 bg-[#0a0c10]/80 backdrop-blur-md border-b border-slate-800/50 px-8 py-6 flex justify-between items-center\">\n          <div>\n            <div className=\"flex items-center gap-2 text-[9px] font-black uppercase tracking-[0.4em] text-orange-500 mb-1\">\n              <span className=\"w-2 h-2 bg-orange-500 rounded-full animate-ping\"></span>\n              EDUControlPro Sistema de Control Parental Educativo v3.0\n            </div>\n            <h1 className=\"text-2xl font-black italic uppercase text-white tracking-tighter\">\n              {institutionName} <span className=\"text-slate-500 font-light ml-2\">/ {activeSection.toUpperCase()}</span>\n            </h1>\n          </div>\n          <button onClick={() => setInstitutionId(null)} className=\"bg-slate-900 border border-slate-800 text-slate-400 hover:text-white px-5 py-2 rounded-xl text-[10px] font-black uppercase italic flex items-center gap-2\">← Volver a Sedes</button>\n        </header>\n\n        <div className=\"p-8 max-w-[1600px] mx-auto grid grid-cols-12 gap-8\">\n          <div className=\"col-span-12 lg:col-span-4 space-y-6\">\n            <div className=\"bg-[#0f1117] p-8 rounded-[2.5rem] border border-slate-800 shadow-2xl\">\n              <h2 className=\"text-xl font-black italic uppercase text-white mb-6 flex items-center gap-3\"><Lock className=\"text-orange-500 w-5 h-5\" /> Master Switch</h2>\n              <div className=\"scale-95 origin-left\"><GlobalControls institutionId={institutionId!} /></div>\n            </div>\n          </div>\n\n          <div className=\"col-span-12 lg:col-span-8\">\n            <div className=\"bg-[#0f1117] p-10 rounded-[3rem] border border-slate-800 min-h-[600px] relative\">\n              \n              {activeSection === 'dashboard' && !selectedAula && (\n                <>\n                  <div className=\"flex justify-between items-center mb-10\">\n                    <h2 className=\"text-4xl font-black italic uppercase text-white tracking-tighter\">Mapa <span className=\"text-orange-500 font-light\">de Aulas</span></h2>\n                    <button onClick={() => { setEditingAula(null); setNewAula({nombre_completo:'', seccion:''}); setShowModal(true); }} className=\"bg-orange-500 hover:bg-orange-600 text-white px-6 py-3 rounded-2xl font-black text-[10px] uppercase italic transition-all flex items-center gap-2\"><Plus className=\"w-4 h-4\" /> Crear Nueva Aula</button>\n                  </div>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    {aulas.map((aula) => (\n                      <button key={aula.id} onClick={() => setSelectedAula(aula)} className=\"bg-slate-900/30 p-8 rounded-[2.5rem] border border-slate-800 hover:border-orange-500 transition-all group text-left relative\">\n                        <DoorOpen className=\"w-8 h-8 text-slate-700 mb-4 group-hover:text-orange-500\" />\n                        <h3 className=\"text-xl font-black italic uppercase text-white\">{aula.nombre_completo}</h3>\n                        <p className=\"text-[10px] font-bold text-slate-500 uppercase\">{aula.seccion || 'SIN SECCIÓN'}</p>\n                        <div className=\"absolute top-6 right-6 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n                          <div title=\"Editar Aula\" onClick={(e) => { e.stopPropagation(); setEditingAula(aula); setNewAula({nombre_completo: aula.nombre_completo, seccion: aula.seccion}); setShowModal(true); }} className=\"p-2 bg-slate-800 hover:text-orange-500 rounded-lg\"><Edit3 size={14} /></div>\n                          <div title=\"Eliminar Aula\" onClick={(e) => handleDeleteAula(e, aula.id)} className=\"p-2 bg-slate-800 hover:text-red-500 rounded-lg\"><Trash2 size={14} /></div>\n                        </div>\n                      </button>\n                    ))}\n                  </div>\n                </>\n              )}\n\n              {activeSection === 'security' && (\n                <div className=\"animate-in fade-in duration-500\">\n                  <SecurityRules institutionId={institutionId!} />\n                </div>\n              )}\n\n              {activeSection === 'users' && (\n                <div className=\"space-y-8\">\n                  <div className=\"flex justify-between items-center\">\n                    <h2 className=\"text-4xl font-black italic uppercase text-white tracking-tighter\">Directorio <span className=\"text-orange-500 font-light\">Global</span></h2>\n                    <div className=\"relative\">\n                      <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500\" />\n                      <input placeholder=\"BUSCAR POR NOMBRE O ID...\" className=\"bg-slate-900 border border-slate-800 rounded-2xl pl-12 pr-6 py-3 text-[10px] font-bold uppercase text-white w-72 outline-none focus:border-orange-500 transition-all\" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />\n                    </div>\n                  </div>\n                  <div className=\"overflow-hidden rounded-[2rem] border border-slate-800 bg-slate-900/20\">\n                    <table className=\"w-full text-[10px]\">\n                      <thead className=\"bg-slate-900/80 border-b border-slate-800 text-slate-500\">\n                        <tr>\n                          <th className=\"px-6 py-5 text-left uppercase font-black italic\">Alumno / Hardware</th>\n                          <th className=\"px-6 py-5 text-left uppercase font-black italic\">Aula Asignada</th>\n                          <th className=\"px-6 py-5 text-right uppercase font-black italic\">Acciones</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        {filteredUsers.map((alumno) => {\n                          const device = tablets.find(t => t.id === alumno.tabletId);\n                          const isReq = activeUrlRequest === alumno.id;\n                          return (\n                            <tr key={alumno.id} className=\"border-b border-slate-800/30 hover:bg-slate-800/10 transition-all group\">\n                              <td className=\"px-6 py-5\">\n                                {editingUser?.id === alumno.id ? (\n                                  <input className=\"bg-black border border-orange-500 rounded px-2 py-1 text-white uppercase text-[10px]\" value={editingUser.nombre} onChange={e => setEditingUser({...editingUser, nombre: e.target.value})} />\n                                ) : (\n                                  <div>\n                                    <p className=\"font-black text-white italic uppercase\">{alumno.nombre}</p>\n                                    <p className=\"text-[8px] font-bold text-blue-500 flex items-center gap-1 mt-1 opacity-70\"><HardDrive size={10}/> {device?.mac_address || device?.imei || device?.id || 'NO VINCULADO'}</p>\n                                  </div>\n                                )}\n                              </td>\n                              <td className=\"px-6 py-5\">\n                                {editingUser?.id === alumno.id ? (\n                                  <select className=\"bg-black border border-orange-500 rounded px-2 py-1 text-white uppercase text-[9px]\" value={editingUser.aulaId} onChange={e => setEditingUser({...editingUser, aulaId: e.target.value})}>\n                                    <option value=\"\">SIN ASIGNAR</option>\n                                    {aulas.map(a => <option key={a.id} value={a.id}>{a.nombre_completo}</option>)}\n                                  </select>\n                                ) : (\n                                  <span className=\"uppercase font-bold text-slate-400\">{aulas.find(a => a.id === alumno.aulaId)?.nombre_completo || 'SIN AULA'}</span>\n                                )}\n                              </td>\n                              <td className=\"px-6 py-5\">\n                                <div className=\"flex gap-2 justify-end items-center\">\n                                  {isReq && device && (\n                                    <div className=\"bg-orange-500/10 border border-orange-500/20 px-3 py-1 rounded-lg animate-in fade-in slide-in-from-right-1\">\n                                      <p className=\"text-[7px] font-black text-orange-500 uppercase\">En Vivo:</p>\n                                      <p className=\"text-[9px] text-white font-medium truncate max-w-[120px]\">{device.last_url || 'SISTEMA'}</p>\n                                    </div>\n                                  )}\n                                  <button title=\"Consultar URL en Vivo\" onClick={() => setActiveUrlRequest(isReq ? null : alumno.id)} className={`p-2 rounded-lg transition-all ${isReq ? 'bg-orange-500 text-white' : 'bg-slate-800 text-slate-400 hover:text-white'}`}><Link2 size={14} /></button>\n                                  <button title=\"Ver Historial Web (Top 20)\" onClick={() => setHistoryModal({ isOpen: true, tabletId: alumno.tabletId || \"\", alumnoNombre: alumno.nombre })} className=\"p-2 bg-slate-800 rounded-lg text-slate-400 hover:text-orange-500 transition-all\"><Globe size={14} /></button>\n                                  {editingUser?.id === alumno.id ? (\n                                    <button title=\"Guardar Cambios\" onClick={handleUpdateUser} className=\"p-2 bg-green-600 rounded-lg text-white\"><Check size={14} /></button>\n                                  ) : (\n                                    <button title=\"Modificar Datos y Aula\" onClick={() => setEditingUser({id: alumno.id, nombre: alumno.nombre, aulaId: alumno.aulaId})} className=\"p-2 bg-slate-800 rounded-lg text-slate-400 hover:text-blue-500 transition-all\"><Edit3 size={14} /></button>\n                                  )}\n                                  <button title=\"Eliminar Alumno y Liberar Hardware\" onClick={() => handleDeleteUser(alumno.id, alumno.tabletId)} className=\"p-2 bg-slate-800 rounded-lg text-slate-400 hover:text-red-500 transition-all\"><Trash2 size={14} /></button>\n                                </div>\n                              </td>\n                            </tr>\n                          );\n                        })}\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              )}\n\n              {selectedAula && activeSection === 'dashboard' && (\n                <>\n                  <button onClick={() => setSelectedAula(null)} className=\"mb-8 flex items-center gap-2 text-[10px] font-black uppercase text-slate-500 hover:text-orange-500\"><ArrowLeft className=\"w-3 h-3\" /> Regresar</button>\n                  <div className=\"grid grid-cols-1 gap-4\">\n                    {alumnos.map((alumno) => {\n                      const device = tablets.find(t => t.id === alumno.tabletId);\n                      return (\n                        <div key={alumno.id} className=\"flex items-center justify-between p-6 bg-slate-900/50 rounded-[2rem] border border-slate-800 gap-4\">\n                          <div className=\"flex items-center gap-4 flex-1\">\n                            <div className=\"w-12 h-12 bg-slate-800 rounded-2xl flex items-center justify-center\"><User className={device?.online ? \"text-orange-500\" : \"text-slate-500\"} /></div>\n                            <div>\n                              <p className=\"text-sm font-black uppercase text-white italic\">{alumno.nombre}</p>\n                              <span className=\"text-[8px] font-black text-slate-500 uppercase\">{device?.online ? 'EN LÍNEA' : 'OFFLINE'}</span>\n                            </div>\n                          </div>\n                          <div className=\"flex gap-2\">\n                            <button title=\"Enviar Mensaje Directo\" onClick={() => setMessageModal({ isOpen: true, tabletId: alumno.tabletId || '', alumnoNombre: alumno.nombre, text: '' })} className=\"w-12 h-12 rounded-2xl bg-blue-500/10 border border-blue-500/20 flex items-center justify-center hover:bg-blue-500 transition-all group/msg\"><MessageSquare className=\"w-5 h-5 group-hover/msg:text-white\" /></button>\n                            <button title=\"Ver Actividad Reciente\" onClick={() => setHistoryModal({ isOpen: true, tabletId: alumno.tabletId || \"\", alumnoNombre: alumno.nombre })} className=\"w-12 h-12 rounded-2xl bg-orange-500/10 border border-orange-500/20 flex items-center justify-center hover:bg-orange-500 transition-all group/globe\"><Globe className=\"w-5 h-5 group-hover/globe:text-white\" /></button>\n                          </div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </>\n              )}\n\n              {activeSection === 'settings' && (\n                <div className=\"space-y-10\">\n                  <div className=\"flex justify-between items-center\">\n                    <h2 className=\"text-4xl font-black italic uppercase text-white tracking-tighter leading-none\">Configuración <span className=\"text-orange-500 font-light\">de Sede</span></h2>\n                    <button onClick={handleUpdateInstitution} disabled={isSaving} className=\"bg-orange-500 hover:bg-orange-600 disabled:opacity-50 text-white px-6 py-3 rounded-2xl font-black text-[10px] uppercase italic transition-all flex items-center gap-2\">\n                      <Save size={16} /> {isSaving ? 'Guardando...' : 'Guardar Cambios'}\n                    </button>\n                  </div>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    <div className=\"bg-slate-900/40 p-8 rounded-[2.5rem] border border-slate-800 space-y-6\">\n                      <div className=\"flex items-center gap-3 text-orange-500 mb-2\"><Building2 size={16}/><span className=\"text-[10px] font-black uppercase tracking-widest\">Perfil General</span></div>\n                      <div className=\"space-y-2\">\n                        <label className=\"text-[9px] font-black text-slate-500 uppercase italic ml-1\">Nombre de la Sede</label>\n                        <input className={inputStyle} value={institutionName} onChange={(e) => setInstitutionName(e.target.value)} />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <label className=\"text-[9px] font-black text-slate-500 uppercase italic ml-1\">Dirección Física</label>\n                        <div className=\"relative\">\n                          <MapPin size={14} className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-600\" />\n                          <input className={`${inputStyle} pl-12`} placeholder=\"Dirección Completa...\" value={instData.direccion} onChange={(e) => setInstData({...instData, direccion: e.target.value})} />\n                        </div>\n                      </div>\n                      <div className=\"space-y-2\">\n                        <label className=\"text-[9px] font-black text-slate-500 uppercase italic ml-1\">Teléfono de Contacto</label>\n                        <div className=\"relative\">\n                          <Smartphone size={14} className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-600\" />\n                          <input className={`${inputStyle} pl-12`} placeholder=\"+00 000 0000000\" value={instData.telefono} onChange={(e) => setInstData({...instData, telefono: e.target.value})} />\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"bg-slate-900/40 p-8 rounded-[2.5rem] border border-slate-800 space-y-4\">\n                      <div className=\"flex items-center gap-3 text-blue-500 mb-2\"><Key size={16}/><span className=\"text-[10px] font-black uppercase tracking-widest\">Identificador de Sede</span></div>\n                      <div className=\"w-full bg-slate-900 border border-slate-800 rounded-xl px-4 py-3 text-[10px] font-mono text-slate-500 truncate\">{institutionId}</div>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </main>\n\n      {/* MODALES EXTERNOS */}\n      {showModal && (\n        <div className=\"fixed inset-0 bg-[#0a0c10]/95 backdrop-blur-sm z-[100] flex items-center justify-center p-4\">\n          <div className=\"bg-[#0f1117] border border-slate-800 rounded-[3rem] p-10 w-full max-w-md shadow-2xl animate-in zoom-in duration-300\">\n            <h2 className=\"text-3xl font-black italic uppercase text-white mb-8\">\n              {editingAula ? 'Editar' : 'Nueva'} <span className=\"text-orange-500\">Aula</span>\n            </h2>\n            <form onSubmit={handleSaveAula} className=\"space-y-6\">\n              <input placeholder=\"EJ: LABORATORIO\" className={inputStyle} value={newAula.nombre_completo} onChange={e => setNewAula({...newAula, nombre_completo: e.target.value})} />\n              <input placeholder=\"EJ: 5TO AÑO B\" className={inputStyle} value={newAula.seccion} onChange={e => setNewAula({...newAula, seccion: e.target.value})} />\n              <div className=\"grid grid-cols-2 gap-4\">\n                <button type=\"button\" onClick={() => { setShowModal(false); setEditingAula(null); }} className=\"bg-slate-800 text-slate-400 font-black py-5 rounded-xl text-[10px] uppercase italic\">Cancelar</button>\n                <button type=\"submit\" className=\"bg-orange-500 text-white font-black py-5 rounded-xl text-[10px] uppercase italic\">Guardar</button>\n              </div>\n            </form>\n          </div>\n        </div>\n      )}\n\n      {messageModal.isOpen && (\n        <div className=\"fixed inset-0 bg-[#0a0c10]/95 backdrop-blur-md z-[120] flex items-center justify-center p-4\">\n          <div className=\"bg-[#0f1117] border border-slate-800 rounded-[2.5rem] p-10 w-full max-w-md\">\n            <h2 className=\"text-xl font-black italic uppercase text-white mb-6\">Comunicado: <span className=\"text-blue-500\">{messageModal.alumnoNombre}</span></h2>\n            <textarea className=\"w-full bg-slate-900 border border-slate-800 p-4 rounded-xl text-white font-bold text-xs uppercase min-h-[120px] outline-none mb-6\" value={messageModal.text} onChange={(e) => setMessageModal({...messageModal, text: e.target.value})} />\n            <div className=\"flex gap-2\">\n               <button onClick={handleSendMessage} className=\"flex-1 bg-blue-600 p-5 rounded-xl font-black uppercase text-white text-[10px] italic\">Transmitir Alerta</button>\n               <button onClick={() => setMessageModal({...messageModal, isOpen: false})} className=\"p-5 text-[9px] font-black uppercase text-slate-600 italic\">Cerrar</button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      <WebHistoryModal isOpen={historyModal.isOpen} onClose={() => setHistoryModal({ ...historyModal, isOpen: false })} tabletId={historyModal.tabletId} alumnoNombre={historyModal.alumnoNombre} />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3423, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 3427, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/dashboard/DirectorView.tsx"],"sourcesContent":["'use client';\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { db, auth } from '@/firebase/config';\nimport { \n  collection, onSnapshot, query, where, orderBy, doc, getDoc, getDocs, updateDoc, serverTimestamp \n} from 'firebase/firestore';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport { \n  Users, Tablet, Layout, Search, GraduationCap, Briefcase, Activity, User, X, FileText, Printer, \n  Globe, Eye, ShieldCheck, RefreshCw, Zap, Flame, AlertTriangle, Send, MessageSquare, Lock, ShieldAlert\n} from 'lucide-react';\nimport jsPDF from 'jspdf';\nimport html2canvas from 'html2canvas';\nimport { GlobalControls } from '@/components/admin/config/GlobalControls';\nimport { WebHistoryModal } from '@/components/admin/monitoring/WebHistoryModal';\n\nexport default function DirectorView() {\n  const [profesores, setProfesores] = useState<any[]>([]);\n  const [aulas, setAulas] = useState<any[]>([]);\n  const [dispositivos, setDispositivos] = useState<any[]>([]);\n  const [sesionesActivas, setSesionesActivas] = useState<any[]>([]);\n  const [nombreInstituto, setNombreInstituto] = useState('Cargando...');\n  const [nombreDirector, setNombreDirector] = useState('Cargando...');\n  const [showReport, setShowReport] = useState(false);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  \n  const [aulaSeleccionada, setAulaSeleccionada] = useState<any>(null);\n  const [alumnosAula, setAlumnosAula] = useState<any[]>([]);\n  const [lastPulse, setLastPulse] = useState<string>('');\n\n  const [messageModal, setMessageModal] = useState({ isOpen: false, tabletId: '', alumnoNombre: '', text: '' });\n  const [historyModal, setHistoryModal] = useState({ isOpen: false, tabletId: '', alumnoNombre: '' });\n  \n  // Usamos estrictamente \"InstitutoId\" como en tu DB\n  const getInstitutoId = () => {\n    if (typeof window !== 'undefined') {\n      return localStorage.getItem('InstitutoId') || '';\n    }\n    return '';\n  };\n\n  const workingInstitutoId = getInstitutoId();\n\n  const fetchMonitorDocente = useCallback(async () => {\n    if (!workingInstitutoId) return;\n    setIsRefreshing(true);\n    try {\n      const qSesiones = query(\n        collection(db, \"sesiones_monitoreo\"), \n        where(\"InstitutoId\", \"==\", workingInstitutoId),\n        where(\"role\", \"==\", \"profesor\")\n      );\n      const snapshot = await getDocs(qSesiones);\n      setSesionesActivas(snapshot.docs.map(d => ({ id: d.id, ...d.data() })));\n    } catch (err) {\n      console.error(\"Error en sesiones_monitoreo:\", err);\n    } finally {\n      setTimeout(() => setIsRefreshing(false), 1000);\n    }\n  }, [workingInstitutoId]);\n\n  useEffect(() => {\n    if (!workingInstitutoId) return;\n\n    // 1. Nombre de la Institución\n    const fetchNombreInst = async () => {\n      try {\n        const instRef = doc(db, \"institutions\", workingInstitutoId);\n        const instSnap = await getDoc(instRef);\n        if (instSnap.exists()) setNombreInstituto(instSnap.data().nombre || \"Sede EDU\");\n      } catch (err) { console.error(\"Error instituciones:\", err); }\n    };\n    fetchNombreInst();\n\n    // 2. Nombre del Director\n    const unsubAuth = onAuthStateChanged(auth, (user) => {\n      if (user?.email) {\n        const qDir = query(collection(db, \"usuarios\"), where(\"email\", \"==\", user.email.toLowerCase()));\n        onSnapshot(qDir, (snap) => {\n          if (!snap.empty) setNombreDirector(snap.docs[0].data().nombre || 'Director');\n        }, (err) => console.error(\"Error usuarios dir:\", err));\n      }\n    });\n\n    // 3. Profesores\n    const qProf = query(\n        collection(db, \"usuarios\"), \n        where(\"InstitutoId\", \"==\", workingInstitutoId), \n        where(\"role\", \"==\", \"profesor\")\n    );\n    const unsubProf = onSnapshot(qProf, (s) => {\n      setProfesores(s.docs.map(d => ({ id: d.id, ...d.data() })));\n    }, (err) => console.error(\"Error profesores:\", err));\n\n    // 4. Aulas (CORREGIDO: Apuntando a subcolección y usando campos existentes según imagen)\n    const qAulas = query(\n        collection(db, \"institutions\", workingInstitutoId, \"Aulas\"), \n        orderBy(\"aulaId\") \n    );\n    const unsubAulas = onSnapshot(qAulas, (s) => {\n      setAulas(s.docs.map(d => ({ id: d.id, ...d.data() })));\n    }, (err) => {\n        console.error(\"Error aulas:\", err);\n        // Fallback en caso de que el índice de orderBy tarde en propagarse\n        const qAulasSimple = query(collection(db, \"institutions\", workingInstitutoId, \"Aulas\"));\n        onSnapshot(qAulasSimple, (s) => {\n            setAulas(s.docs.map(d => ({ id: d.id, ...d.data() })));\n        });\n    });\n\n    // 5. Dispositivos\n    const qDev = query(\n        collection(db, \"dispositivos\"), \n        where(\"InstitutoId\", \"==\", workingInstitutoId)\n    );\n    const unsubDev = onSnapshot(qDev, (s) => {\n      setDispositivos(s.docs.map(d => ({ id: d.id, ...d.data() })));\n    }, (err) => console.error(\"Error dispositivos:\", err));\n\n    fetchMonitorDocente();\n\n    return () => { unsubAuth(); unsubProf(); unsubAulas(); unsubDev(); };\n  }, [workingInstitutoId, fetchMonitorDocente]);\n\n  // Supervisión táctica de aula\n  useEffect(() => {\n    if (!aulaSeleccionada || !workingInstitutoId) return;\n    const qSup = query(\n      collection(db, \"sesiones_monitoreo\"),\n      where(\"InstitutoId\", \"==\", workingInstitutoId),\n      where(\"aulaId\", \"==\", aulaSeleccionada.aulaId) // Usamos aulaId del documento\n    );\n    const unsubSup = onSnapshot(qSup, (s) => {\n      setAlumnosAula(s.docs.map(d => ({ id: d.id, ...d.data() })));\n      setLastPulse(new Date().toLocaleTimeString());\n    }, (err) => console.error(\"Error monitoreo aula:\", err));\n    return () => unsubSup();\n  }, [aulaSeleccionada, workingInstitutoId]);\n\n  const handleSendMessage = async () => {\n    if (!messageModal.tabletId || !messageModal.text.trim()) return;\n    try {\n      await updateDoc(doc(db, \"dispositivos\", messageModal.tabletId), {\n        pending_message: messageModal.text,\n        message_timestamp: serverTimestamp(),\n        message_sender: \"Dirección Institucional\"\n      });\n      setMessageModal({ ...messageModal, isOpen: false, text: '' });\n    } catch (e) { console.error(e); }\n  };\n\n  const exportToPDF = async () => {\n    const element = document.getElementById('report-content');\n    if (!element) return;\n    try {\n      const canvas = await html2canvas(element, { backgroundColor: '#0f1117', scale: 2 });\n      const imgData = canvas.toDataURL('image/png');\n      const pdf = new jsPDF('p', 'mm', 'a4');\n      const pdfWidth = pdf.internal.pageSize.getWidth();\n      const pdfHeight = (canvas.height * pdfWidth) / canvas.width;\n      pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);\n      pdf.save(`EDU_Reporte_${new Date().getTime()}.pdf`);\n    } catch (error) { console.error(error); }\n  };\n\n  const alerts = dispositivos.filter(t => t.last_url?.includes('block') || t.status === 'restricted');\n\n  if (!workingInstitutoId) return <div className=\"p-10 text-red-500 font-black italic uppercase\">Acceso Denegado. No se encontró InstitutoId.</div>;\n\n  return (\n    <div className=\"animate-in fade-in duration-500 p-4 lg:p-0 relative space-y-8\">\n      {/* HEADER */}\n      <header className=\"flex flex-col md:flex-row justify-between items-start md:items-end gap-6\">\n        <div>\n          <h2 className=\"text-[10px] font-black text-orange-500 uppercase tracking-[0.3em] mb-2 italic\">Director Management</h2>\n          <h1 className=\"text-4xl font-black text-white italic uppercase tracking-tighter leading-none mb-4\">{nombreInstituto}</h1>\n          <div className=\"flex items-center gap-3 bg-slate-900/50 p-2 pr-4 rounded-2xl border border-slate-800 w-fit\">\n            <div className=\"bg-orange-500/20 p-2 rounded-xl text-orange-500\"><User size={16} /></div>\n            <div className=\"flex flex-col\">\n              <span className=\"text-white text-[10px] font-bold uppercase leading-tight\">{nombreDirector}</span>\n              <span className=\"text-orange-500 text-[9px] font-black uppercase italic tracking-[0.15em] mt-0.5\">Director de Sede</span>\n            </div>\n          </div>\n        </div>\n        <button onClick={() => setShowReport(true)} className=\"bg-slate-800 hover:bg-slate-700 text-white px-6 py-3 rounded-xl text-[10px] font-black uppercase italic transition-all flex items-center gap-2 border border-slate-700 shadow-xl\">\n          <Activity size={14} className=\"text-orange-500\" /> Exportar Status\n        </button>\n      </header>\n\n      {/* SECCIÓN TÁCTICA */}\n      <div className=\"grid grid-cols-12 gap-8\">\n        <div className=\"col-span-12 lg:col-span-4 space-y-6\">\n            <div className=\"bg-[#0f1117] p-8 rounded-[2.5rem] border border-slate-800 shadow-2xl\">\n              <h2 className=\"text-xs font-black italic uppercase text-white mb-6 flex items-center gap-3\"><Lock className=\"text-orange-500 w-4 h-4\" /> Control Maestro</h2>\n              <div className=\"scale-90 origin-left\"><GlobalControls institutionId={workingInstitutoId} /></div>\n            </div>\n\n            <div className=\"bg-[#0f1117] p-8 rounded-[2.5rem] border border-slate-800 shadow-xl\">\n               <div className=\"flex justify-between items-center mb-6\">\n                  <h3 className=\"text-[10px] font-black uppercase text-slate-500 tracking-widest italic flex items-center gap-2\">\n                    <Flame size={14} className=\"text-orange-500\" /> Riesgos de Navegación\n                  </h3>\n               </div>\n               <div className=\"space-y-3\">\n                  {alerts.length > 0 ? alerts.slice(0, 4).map((alert, i) => (\n                    <div key={i} className=\"bg-red-500/5 p-4 rounded-2xl border border-red-500/10 group hover:border-red-500/30 transition-all\">\n                        <div className=\"flex justify-between items-start mb-2\">\n                            <p className=\"text-[9px] font-black text-white uppercase italic\">{alert.alumno_asignado || 'Estudiante'}</p>\n                            <AlertTriangle size={12} className=\"text-red-500 animate-pulse\" />\n                        </div>\n                        <div className=\"flex items-center justify-between\">\n                           <p className=\"text-[8px] font-bold text-slate-600 uppercase truncate max-w-[120px]\">{alert.last_url || 'BLOQUEADO'}</p>\n                           <div className=\"flex gap-2\">\n                             <button onClick={() => setHistoryModal({ isOpen: true, tabletId: alert.id, alumnoNombre: alert.alumno_asignado })} className=\"text-slate-500 hover:text-white\"><Globe size={12}/></button>\n                             <button onClick={() => setMessageModal({ isOpen: true, tabletId: alert.id, alumnoNombre: alert.alumno_asignado, text: '' })} className=\"text-[8px] font-black text-orange-500 uppercase hover:text-white\">Notificar</button>\n                           </div>\n                        </div>\n                    </div>\n                  )) : (\n                    <div className=\"text-center py-6 border border-dashed border-slate-800 rounded-3xl\">\n                        <ShieldCheck size={24} className=\"text-slate-800 mx-auto mb-2\" />\n                        <p className=\"text-[9px] font-black text-slate-600 uppercase italic\">Sin Infracciones</p>\n                    </div>\n                  )}\n               </div>\n            </div>\n        </div>\n\n        <div className=\"col-span-12 lg:col-span-8\">\n            <section className=\"bg-[#0f1117] border border-slate-800 rounded-[2.5rem] overflow-hidden shadow-2xl h-full\">\n                <div className=\"p-8 border-b border-slate-800 bg-black/40 flex justify-between items-center\">\n                <h3 className=\"text-xs font-black text-white uppercase italic flex items-center gap-2\">\n                    <Globe className=\"text-orange-500\" size={16} /> Monitor Docente\n                </h3>\n                <button \n                    onClick={fetchMonitorDocente}\n                    disabled={isRefreshing}\n                    className={`flex items-center gap-2 px-4 py-2 rounded-xl text-[9px] font-black uppercase italic transition-all ${isRefreshing ? 'bg-slate-800 text-slate-500' : 'bg-orange-500 text-white shadow-lg shadow-orange-500/20 hover:scale-105'}`}\n                >\n                    {isRefreshing ? <RefreshCw size={12} className=\"animate-spin\" /> : <Zap size={12} />}\n                    {isRefreshing ? 'Sincronizando...' : 'Sincronizar'}\n                </button>\n                </div>\n                <div className=\"p-6 grid grid-cols-1 md:grid-cols-2 gap-4\">\n                {sesionesActivas.length > 0 ? sesionesActivas.map(sesion => (\n                    <div key={sesion.id} className=\"bg-slate-900/40 border border-slate-800/60 p-5 rounded-3xl group\">\n                    <div className=\"flex items-center gap-3 mb-3\">\n                        <div className=\"bg-blue-500/10 p-2 rounded-xl text-blue-500\"><Briefcase size={16} /></div>\n                        <div>\n                        <p className=\"text-[10px] font-black text-white uppercase italic\">{sesion.usuario}</p>\n                        <p className=\"text-[8px] text-slate-500 font-bold uppercase\">ID: {sesion.tabletId}</p>\n                        </div>\n                    </div>\n                    <div className=\"bg-black/40 p-3 rounded-2xl border border-slate-800/50\">\n                        <p className=\"text-[10px] text-blue-400 font-bold truncate lowercase\">{sesion.url_actual || 'efas-control.pro'}</p>\n                    </div>\n                    </div>\n                )) : (\n                    <div className=\"col-span-full flex flex-col items-center justify-center py-10 text-slate-600\">\n                    <RefreshCw size={24} className=\"mb-2 opacity-20\" />\n                    <p className=\"text-[9px] font-black uppercase italic\">Esperando actividad docente...</p>\n                    </div>\n                )}\n                </div>\n            </section>\n        </div>\n      </div>\n\n      {/* STATS RÁPIDOS */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <div className=\"bg-[#0f1117] border border-slate-800 p-6 rounded-[2rem] flex items-center gap-5\">\n           <Briefcase className=\"text-blue-500\" size={24} />\n           <div><p className=\"text-[9px] font-black text-slate-500 uppercase italic\">Docentes</p><p className=\"text-2xl font-black text-white italic\">{profesores.length}</p></div>\n        </div>\n        <div className=\"bg-[#0f1117] border border-slate-800 p-6 rounded-[2rem] flex items-center gap-5\">\n           <Layout className=\"text-orange-500\" size={24} />\n           <div><p className=\"text-[9px] font-black text-slate-500 uppercase italic\">Aulas</p><p className=\"text-2xl font-black text-white italic\">{aulas.length}</p></div>\n        </div>\n        <div className=\"bg-[#0f1117] border border-slate-800 p-6 rounded-[2rem] flex items-center gap-5\">\n           <Tablet className=\"text-green-500\" size={24} />\n           <div><p className=\"text-[9px] font-black text-slate-500 uppercase italic\">Dispositivos</p><p className=\"text-2xl font-black text-white italic\">{dispositivos.length}</p></div>\n        </div>\n      </div>\n\n      {/* SUPERVISIÓN PERSONAL */}\n      <div className=\"grid grid-cols-12 gap-8\">\n        <div className=\"col-span-12 lg:col-span-8\">\n          <section className=\"bg-[#0f1117] border border-slate-800 rounded-[2.5rem] overflow-hidden shadow-2xl\">\n            <div className=\"p-8 border-b border-slate-800 flex justify-between items-center bg-black/20\">\n              <h3 className=\"text-xs font-black text-white uppercase italic flex items-center gap-2\">\n                <Users className=\"text-orange-500\" size={16} /> Supervisión de Personal\n              </h3>\n            </div>\n            <div className=\"p-4 overflow-x-auto\">\n              <table className=\"w-full text-left\">\n                <thead>\n                  <tr className=\"text-[9px] font-black text-slate-600 uppercase italic\">\n                    <th className=\"p-4\">Nombre / Email</th>\n                    <th className=\"p-4\">Terminal ID</th>\n                    <th className=\"p-4\">Estado</th>\n                  </tr>\n                </thead>\n                <tbody className=\"divide-y divide-slate-800/50\">\n                  {profesores.map(p => (\n                    <tr key={p.id} className=\"hover:bg-white/[0.03] text-[10px]\">\n                      <td className=\"p-4\">\n                        <p className=\"text-white font-bold uppercase\">{p.nombre || 'Sin nombre'}</p>\n                        <p className=\"text-slate-500\">{p.email}</p>\n                      </td>\n                      <td className=\"p-4 font-black uppercase italic text-blue-500\">{p.tabletId || '---'}</td>\n                      <td className=\"p-4\">\n                        <span className=\"bg-green-500/10 text-green-500 border border-green-500/20 px-2 py-1 rounded-lg text-[8px] font-black uppercase italic\">Adscrito</span>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </section>\n        </div>\n        <div className=\"col-span-12 lg:col-span-4\">\n           <section className=\"bg-[#0f1117] border border-slate-800 rounded-[2.5rem] p-8 shadow-2xl\">\n              <div className=\"flex items-center gap-2 mb-6\">\n                <ShieldCheck className=\"text-orange-500\" size={18} />\n                <h3 className=\"text-xs font-black text-white uppercase italic\">Supervisión de Aulas</h3>\n              </div>\n              <div className=\"space-y-3\">\n                {aulas.map(a => (\n                  <button \n                    key={a.id} \n                    onClick={() => setAulaSeleccionada(a)}\n                    className=\"w-full bg-slate-900/30 border border-slate-800 p-4 rounded-2xl flex justify-between items-center border-l-4 border-l-orange-500 hover:bg-orange-500/5 transition-all group\"\n                  >\n                    <div className=\"text-left\">\n                      <p className=\"text-white font-black text-[11px] uppercase italic group-hover:text-orange-500 transition-colors\">\n                        {a.aulaId}\n                      </p>\n                      <p className=\"text-[9px] text-slate-500 font-bold uppercase italic\">Sección: {a.seccion}</p>\n                    </div>\n                    <Eye size={16} className=\"text-slate-700 group-hover:text-orange-500 transition-colors\" />\n                  </button>\n                ))}\n              </div>\n           </section>\n        </div>\n      </div>\n\n      {/* MODAL SUPERVISIÓN LIVE AULA */}\n      {aulaSeleccionada && (\n        <div className=\"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/95 backdrop-blur-xl\">\n          <div className=\"bg-[#0f1117] border border-slate-800 w-full max-w-4xl rounded-[2.5rem] overflow-hidden shadow-2xl flex flex-col max-h-[90vh]\">\n            <div className=\"p-8 border-b border-slate-800 flex justify-between items-center bg-black/40 text-white\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"bg-orange-500 p-3 rounded-2xl animate-pulse shadow-lg shadow-orange-500/20\"><Layout size={24} /></div>\n                <div>\n                  <h3 className=\"font-black italic uppercase text-lg\">{aulaSeleccionada.aulaId} - {aulaSeleccionada.seccion}</h3>\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"text-[10px] text-orange-500 font-black uppercase italic tracking-widest\">Monitoreo Live</span>\n                    <span className=\"text-[8px] text-slate-500 font-bold uppercase\">Último Pulso: {lastPulse}</span>\n                  </div>\n                </div>\n              </div>\n              <button onClick={() => setAulaSeleccionada(null)} className=\"hover:bg-red-500 p-2 rounded-full transition-colors\"><X size={24} /></button>\n            </div>\n            <div className=\"p-8 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {alumnosAula.length > 0 ? alumnosAula.map(al => (\n                <div key={al.id} className=\"bg-slate-900/50 border border-slate-800 p-4 rounded-3xl border-l-4 border-l-blue-500\">\n                  <div className=\"flex justify-between items-center mb-2\">\n                    <span className=\"text-white font-bold text-xs uppercase\">{al.usuario}</span>\n                    <span className=\"text-[9px] text-slate-600 font-black italic\">TABLET: {al.tabletId}</span>\n                  </div>\n                  <div className=\"bg-black/40 p-3 rounded-xl border border-slate-800/50\">\n                    <p className=\"text-[10px] text-blue-400 font-medium truncate\">{al.url_actual || 'Pestaña del Sistema'}</p>\n                  </div>\n                </div>\n              )) : (\n                <div className=\"col-span-full py-20 text-center text-slate-500 font-black uppercase italic text-xs\">Sin tráfico detectado en este aula</div>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* MODAL REPORTE */}\n      {showReport && (\n        <div className=\"fixed inset-0 z-[120] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm\">\n          <div className=\"bg-[#0f1117] border border-slate-800 w-full max-w-md rounded-[2.5rem] overflow-hidden shadow-2xl\">\n            <div id=\"report-content\" className=\"p-8 space-y-6 bg-[#0f1117]\">\n                <div className=\"flex justify-between items-center border-b border-slate-800 pb-4\">\n                   <h3 className=\"text-white font-black italic uppercase text-lg tracking-tighter\">Status Report</h3>\n                   <button onClick={() => setShowReport(false)} className=\"text-slate-500 hover:text-white\"><X size={20} /></button>\n                </div>\n                <div className=\"space-y-4\">\n                   <div className=\"flex justify-between border-b border-slate-800/50 pb-2 text-[10px] font-black uppercase italic\">\n                     <span className=\"text-slate-500\">Director</span>\n                     <span className=\"text-white\">{nombreDirector}</span>\n                   </div>\n                   <div className=\"flex justify-between border-b border-slate-800/50 pb-2 text-[10px] font-black uppercase italic\">\n                     <span className=\"text-slate-500\">Sede</span>\n                     <span className=\"text-white\">{nombreInstituto}</span>\n                   </div>\n                </div>\n            </div>\n            <div className=\"p-8 pt-0 grid grid-cols-2 gap-3\">\n              <button onClick={() => window.print()} className=\"bg-slate-800 text-white font-black uppercase italic text-[10px] py-4 rounded-2xl flex items-center justify-center gap-2\">\n                <Printer size={14} /> Imprimir\n              </button>\n              <button onClick={exportToPDF} className=\"bg-orange-500 text-white font-black uppercase italic text-[10px] py-4 rounded-2xl flex items-center justify-center gap-2\">\n                <FileText size={14} /> PDF\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* MODAL MENSAJERÍA */}\n      {messageModal.isOpen && (\n        <div className=\"fixed inset-0 bg-black/95 backdrop-blur-md z-[200] flex items-center justify-center p-4\">\n          <div className=\"bg-[#0f1117] border border-slate-800 rounded-[2.5rem] p-10 w-full max-w-md shadow-2xl\">\n            <h2 className=\"text-xl font-black italic uppercase text-white tracking-tighter mb-4 flex items-center gap-2\">\n                <ShieldAlert className=\"text-blue-500\" size={20} /> Aviso de <span className=\"text-blue-500\">Dirección</span>\n            </h2>\n            <textarea \n              placeholder=\"ESCRIBA EL COMUNICADO...\" \n              className=\"w-full bg-slate-900 border border-slate-800 p-5 rounded-2xl text-white font-bold text-xs uppercase min-h-[140px] outline-none focus:border-blue-500 mb-6\" \n              value={messageModal.text} \n              onChange={(e) => setMessageModal({...messageModal, text: e.target.value})} \n            />\n            <div className=\"flex gap-2\">\n               <button onClick={handleSendMessage} className=\"flex-1 bg-blue-600 p-5 rounded-xl font-black uppercase text-white text-xs\">Enviar Alerta</button>\n               <button onClick={() => setMessageModal({...messageModal, isOpen: false})} className=\"p-5 text-[9px] font-black uppercase text-slate-600\">Cerrar</button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      <WebHistoryModal \n        isOpen={historyModal.isOpen} \n        onClose={() => setHistoryModal({ ...historyModal, isOpen: false })} \n        tabletId={historyModal.tabletId} \n        alumnoNombre={historyModal.alumnoNombre} \n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4983, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,mNAAgB,CAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,yHAAE,EACX,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,mNAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,yHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,mNAAgB,CAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,yHAAE,EACX,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,mNAAgB,CAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,yHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,mNAAgB,CAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,IAAA,yHAAE,EAAC,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,mNAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,IAAA,yHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 5068, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AAEA;;;;AAEA,MAAM,gBAAgB,IAAA,uKAAG,EACvB,0KACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SAAS;QACX;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAOF,SAAS,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAmB;IACzD,qBACE,8OAAC;QAAI,WAAW,IAAA,yHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QAAa,GAAG,KAAK;;;;;;AAExE","debugId":null}},
    {"offset": {"line": 5110, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/sheet.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;AACA;AAEA;AAPA;;;;;;;AASA,MAAM,QAAQ,0KAAmB;AAEjC,MAAM,eAAe,6KAAsB;AAE3C,MAAM,aAAa,2KAAoB;AAEvC,MAAM,cAAc,4KAAqB;AAEzC,MAAM,6BAAe,mNAAgB,CAGnC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,6KAAsB;QACrB,WAAW,IAAA,yHAAE,EACX,2JACA;QAED,GAAG,KAAK;QACT,KAAK;;;;;;AAGT,aAAa,WAAW,GAAG,6KAAsB,CAAC,WAAW;AAE7D,MAAM,gBAAgB,IAAA,uKAAG,EACvB,oMACA;IACE,UAAU;QACR,MAAM;YACJ,KAAK;YACL,QACE;YACF,MAAM;YACN,OACE;QACJ;IACF;IACA,iBAAiB;QACf,MAAM;IACR;AACF;AAOF,MAAM,6BAAe,mNAAgB,CAGnC,CAAC,EAAE,OAAO,OAAO,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpD,8OAAC;;0BACC,8OAAC;;;;;0BACD,8OAAC,6KAAsB;gBACrB,KAAK;gBACL,WAAW,IAAA,yHAAE,EAAC,cAAc;oBAAE;gBAAK,IAAI;gBACtC,GAAG,KAAK;;oBAER;kCACD,8OAAC,2KAAoB;wBAAC,WAAU;;0CAC9B,8OAAC,iMAAC;gCAAC,WAAU;;;;;;0CACb,8OAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAKlC,aAAa,WAAW,GAAG,6KAAsB,CAAC,WAAW;AAE7D,MAAM,cAAc,CAAC,EACnB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,IAAA,yHAAE,EACX,oDACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,cAAc,CAAC,EACnB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,IAAA,yHAAE,EACX,iEACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,mNAAgB,CAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,2KAAoB;QACnB,KAAK;QACL,WAAW,IAAA,yHAAE,EAAC,yCAAyC;QACtD,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG,2KAAoB,CAAC,WAAW;AAEzD,MAAM,iCAAmB,mNAAgB,CAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,iLAA0B;QACzB,KAAK;QACL,WAAW,IAAA,yHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG,iLAA0B,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 5267, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/dashboard/ProfesorView.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { db } from '@/firebase/config';\nimport { collection, query, where, onSnapshot, orderBy, limit, doc, updateDoc } from 'firebase/firestore';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { \n  Monitor, Clock, Globe, ShieldAlert, ShieldOff, ShieldCheck \n} from 'lucide-react';\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\";\n\n// Definición de Props para eliminar el error en page.tsx\ninterface ProfesorViewProps {\n  professorId: string;\n  institutoId: string;\n}\n\ninterface Estudiante {\n  id: string;\n  nombre: string;\n  deviceId: string;\n  seccion: string;\n  aulaId: string;\n  bloqueado?: boolean;\n}\n\ninterface Actividad {\n  url: string;\n  titulo: string;\n  timestamp: any;\n}\n\nexport default function ProfesorView({ professorId, institutoId }: ProfesorViewProps) {\n  const [estudiantes, setEstudiantes] = useState<Estudiante[]>([]);\n  const [selectedAlumno, setSelectedAlumno] = useState<Estudiante | null>(null);\n  const [historial, setHistorial] = useState<Actividad[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  // Configuración de branding dinámico\n  const profesorAula = \"LABORATORIO\"; \n  const institutoNombre = `SEDE: ${institutoId}`;\n\n  useEffect(() => {\n    // Consulta filtrada por el InstitutoId recibido por props\n    const q = query(\n      collection(db, \"usuarios\"),\n      where(\"InstitutoId\", \"==\", institutoId),\n      where(\"aulaId\", \"==\", profesorAula),\n      where(\"role\", \"==\", \"estudiante\")\n    );\n\n    const unsubscribe = onSnapshot(q, (snapshot) => {\n      const docs: Estudiante[] = [];\n      snapshot.forEach((doc) => {\n        docs.push({ id: doc.id, ...doc.data() } as Estudiante);\n      });\n      setEstudiantes(docs);\n      setLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, [institutoId, profesorAula]);\n\n  useEffect(() => {\n    if (!selectedAlumno) return;\n    const qActividad = query(\n      collection(db, \"sesiones_monitoreo\"),\n      where(\"deviceId\", \"==\", selectedAlumno.deviceId),\n      orderBy(\"timestamp\", \"desc\"),\n      limit(10)\n    );\n    const unsubscribeActividad = onSnapshot(qActividad, (snapshot) => {\n      const logs: Actividad[] = [];\n      snapshot.forEach((doc) => logs.push(doc.data() as Actividad));\n      setHistorial(logs);\n    });\n    return () => unsubscribeActividad();\n  }, [selectedAlumno]);\n\n  const toggleBloqueo = async (alumno: Estudiante) => {\n    try {\n      const alumnoRef = doc(db, \"usuarios\", alumno.id);\n      await updateDoc(alumnoRef, {\n        bloqueado: !alumno.bloqueado\n      });\n      if (selectedAlumno?.id === alumno.id) {\n        setSelectedAlumno({ ...alumno, bloqueado: !alumno.bloqueado });\n      }\n    } catch (error) {\n      console.error(\"Error al cambiar estado de bloqueo:\", error);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center p-20\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-[#f97316]\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 space-y-6 bg-[#0f1117] min-h-screen text-slate-200 font-sans\">\n      {/* HEADER ACTUALIZADO A EDUControlPro */}\n      <div className=\"flex justify-between items-center border-b border-slate-800 pb-6\">\n        <div>\n          <h1 className=\"text-3xl font-black uppercase italic tracking-tighter text-white\">\n            EDU<span className=\"text-[#f97316]\">ControlPro</span>\n          </h1>\n          <p className=\"text-[#f97316] text-[10px] font-bold uppercase tracking-widest mt-1\">\n            {institutoNombre} | AULA: {profesorAula} | PROFESOR: {professorId.substring(0,5)}\n          </p>\n        </div>\n        <Badge className=\"bg-slate-800 text-slate-400 border-slate-700 px-4 py-1\">\n          {estudiantes.length} ALUMNOS ACTIVOS\n        </Badge>\n      </div>\n\n      {/* GRID DE ALUMNOS */}\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\">\n        {estudiantes.map((estudiante) => (\n          <Card key={estudiante.id} className={`bg-slate-900 border-2 transition-all ${estudiante.bloqueado ? 'border-red-500/50 shadow-[0_0_15px_rgba(239,68,68,0.1)]' : 'border-slate-800 hover:border-[#f97316]'}`}>\n            <CardHeader className=\"pb-2\">\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-[10px] font-black text-slate-500 uppercase\">{estudiante.seccion}</span>\n                <div className={`h-2.5 w-2.5 rounded-full ${estudiante.bloqueado ? 'bg-red-500 shadow-[0_0_8px_#ef4444]' : 'bg-green-500 shadow-[0_0_8px_#22c55e]'}`} />\n              </div>\n              <CardTitle className=\"text-sm font-black text-white uppercase mt-2\">{estudiante.nombre}</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-2\">\n              <button \n                onClick={() => setSelectedAlumno(estudiante)}\n                className=\"w-full py-2.5 bg-slate-800 hover:bg-white hover:text-black text-white text-[10px] font-black uppercase italic rounded-xl transition-all flex items-center justify-center gap-2\"\n              >\n                <Monitor size={14} />\n                MONITOREAR\n              </button>\n              <button \n                onClick={() => toggleBloqueo(estudiante)}\n                className={`w-full py-2.5 text-[10px] font-black uppercase italic rounded-xl transition-all flex items-center justify-center gap-2 border-2 ${estudiante.bloqueado ? 'bg-red-500 text-white border-red-500' : 'border-red-500/20 text-red-500 hover:bg-red-500 hover:text-white'}`}\n              >\n                {estudiante.bloqueado ? <ShieldOff size={14} /> : <ShieldAlert size={14} />}\n                {estudiante.bloqueado ? 'DESBLOQUEAR NAV.' : 'BLOQUEAR NAV.'}\n              </button>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {/* MODAL DE MONITOREO */}\n      <Sheet open={!!selectedAlumno} onOpenChange={() => setSelectedAlumno(null)}>\n        <SheetContent side=\"right\" className=\"w-full sm:max-w-md bg-[#0f1117] border-slate-800 text-white p-0\">\n          <SheetHeader className=\"p-6 border-b border-slate-800 bg-slate-900/50\">\n            <SheetTitle className=\"text-[#f97316] font-black uppercase italic\">VISTA EN VIVO</SheetTitle>\n            <div className=\"mt-2\">\n              <p className=\"text-xl font-black uppercase\">{selectedAlumno?.nombre}</p>\n              <p className=\"text-[10px] text-slate-500 font-bold uppercase tracking-widest\">DEVICE: {selectedAlumno?.deviceId}</p>\n            </div>\n          </SheetHeader>\n\n          <div className=\"p-6 space-y-6\">\n            <div className={`flex items-center gap-2 ${selectedAlumno?.bloqueado ? 'text-red-500' : 'text-green-500'}`}>\n              <ShieldCheck size={16} />\n              <span className=\"text-[10px] font-black uppercase tracking-widest\">\n                {selectedAlumno?.bloqueado ? 'MODO RESTRICCIÓN ACTIVO' : 'NAVEGACIÓN SUPERVISADA'}\n              </span>\n            </div>\n\n            <div className=\"space-y-4\">\n              <h3 className=\"text-[10px] font-black uppercase text-slate-500 tracking-widest flex items-center gap-2\">\n                <Clock size={12} /> HISTORIAL DE ACTIVIDAD\n              </h3>\n              \n              <div className=\"space-y-3\">\n                {historial.length > 0 ? (\n                  historial.map((log, i) => (\n                    <div key={i} className=\"p-4 bg-slate-900/80 border border-slate-800 rounded-2xl flex items-start gap-3\">\n                      <div className=\"p-2 bg-[#f97316]/10 rounded-lg\">\n                        <Globe size={16} className=\"text-[#f97316]\" />\n                      </div>\n                      <div className=\"flex-1 overflow-hidden\">\n                        <p className=\"text-[11px] font-black uppercase text-white truncate\">{log.titulo || 'Sitio Web'}</p>\n                        <p className=\"text-[9px] text-slate-500 font-bold truncate lowercase italic\">{log.url}</p>\n                      </div>\n                    </div>\n                  ))\n                ) : (\n                  <div className=\"py-10 text-center border-2 border-dashed border-slate-800 rounded-[2rem]\">\n                    <p className=\"text-[10px] font-black uppercase text-slate-600 tracking-tighter\">SIN REGISTROS EN ESTA SESIÓN</p>\n                  </div>\n                )}\n              </div>\n            </div>\n\n            <button \n              onClick={() => selectedAlumno && toggleBloqueo(selectedAlumno)}\n              className={`w-full py-4 text-[11px] font-black uppercase italic rounded-2xl transition-all border-2 ${selectedAlumno?.bloqueado ? 'bg-green-500 border-green-500 text-white' : 'border-red-500 text-red-500 hover:bg-red-500 hover:text-white'}`}\n            >\n              {selectedAlumno?.bloqueado ? 'DESBLOQUEAR ACCESO' : 'BLOQUEAR ACCESO INMEDIATO'}\n            </button>\n          </div>\n        </SheetContent>\n      </Sheet>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5748, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/hooks/use-auth.ts"],"sourcesContent":["'use client';\nimport { useState, useEffect } from 'react';\nimport { auth, db } from '@/firebase/config';\nimport { onAuthStateChanged, User } from 'firebase/auth';\nimport { doc, getDoc } from 'firebase/firestore';\n\nexport const useAuth = () => {\n  const [user, setUser] = useState<User | null>(null);\n  const [userData, setUserData] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (firebaseUser) => {\n      if (firebaseUser) {\n        setUser(firebaseUser);\n        // Intentar obtener datos extra del usuario (como su rol e InstitutoId)\n        const docRef = doc(db, \"users\", firebaseUser.uid);\n        const docSnap = await getDoc(docRef);\n        if (docSnap.exists()) {\n          setUserData(docSnap.data());\n        }\n      } else {\n        setUser(null);\n        setUserData(null);\n      }\n      setLoading(false);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  return { user, userData, loading, isSuperAdmin: user?.email === 'vallecondo@gmail.com' };\n};\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AAAA;AACA;AAAA;AAJA;;;;;AAMO,MAAM,UAAU;IACrB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAc;IAC9C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAM;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACR,MAAM,cAAc,IAAA,oNAAkB,EAAC,iIAAI,EAAE,OAAO;YAClD,IAAI,cAAc;gBAChB,QAAQ;gBACR,uEAAuE;gBACvE,MAAM,SAAS,IAAA,wKAAG,EAAC,+HAAE,EAAE,SAAS,aAAa,GAAG;gBAChD,MAAM,UAAU,MAAM,IAAA,2KAAM,EAAC;gBAC7B,IAAI,QAAQ,MAAM,IAAI;oBACpB,YAAY,QAAQ,IAAI;gBAC1B;YACF,OAAO;gBACL,QAAQ;gBACR,YAAY;YACd;YACA,WAAW;QACb;QAEA,OAAO,IAAM;IACf,GAAG,EAAE;IAEL,OAAO;QAAE;QAAM;QAAU;QAAS,cAAc,MAAM,UAAU;IAAuB;AACzF","debugId":null}},
    {"offset": {"line": 5796, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28admin%29/dashboard/page.tsx"],"sourcesContent":["'use client';\nimport { useEffect, useState } from 'react';\nimport { useInstitution } from '@/app/(admin)/dashboard/institution-context';\nimport InstitutionView from '@/components/dashboard/InstitutionView';\nimport SuperAdminView from '@/components/dashboard/SuperAdminView';\nimport DirectorView from '@/components/dashboard/DirectorView';\nimport ProfesorView from '@/components/dashboard/ProfesorView';\nimport { useAuth } from '@/hooks/use-auth';\n\nexport default function DashboardPage() {\n  const { institutionId } = useInstitution();\n  const { user, userData } = useAuth();\n  const [role, setRole] = useState<string | null>(null);\n  const [isMounted, setIsMounted] = useState(false);\n\n  useEffect(() => {\n    const savedRole = localStorage.getItem('userRole');\n    setRole(savedRole);\n    setIsMounted(true);\n  }, []);\n\n  if (!isMounted) {\n    return (\n      <div className=\"min-h-screen bg-[#0a0c10] flex items-center justify-center\">\n        <div className=\"w-8 h-8 border-2 border-orange-500 border-t-transparent rounded-full animate-spin\"></div>\n      </div>\n    );\n  }\n\n  // 1. LÓGICA SUPER ADMIN\n  if (role === 'super-admin') {\n    if (institutionId) return <main><InstitutionView /></main>;\n    return <main><SuperAdminView /></main>;\n  }\n\n  // 2. LÓGICA DIRECTOR\n  if (role === 'director') return <main><DirectorView /></main>;\n\n  // 3. LÓGICA PROFESOR (Nueva)\n  if (role === 'profesor') {\n    return (\n      <main>\n        <ProfesorView \n          professorId={user?.uid || ''} \n          institutoId={userData?.InstitutoId || 'default'} \n        />\n      </main>\n    );\n  }\n\n  // Fallback de seguridad por defecto\n  return <main><InstitutionView /></main>;\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;;AASe,SAAS;IACtB,MAAM,EAAE,aAAa,EAAE,GAAG,IAAA,iLAAc;IACxC,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,IAAA,sIAAO;IAClC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAgB;IAChD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAE3C,IAAA,kNAAS,EAAC;QACR,MAAM,YAAY,aAAa,OAAO,CAAC;QACvC,QAAQ;QACR,aAAa;IACf,GAAG,EAAE;IAEL,IAAI,CAAC,WAAW;QACd,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;;;;;;;;;;IAGrB;IAEA,wBAAwB;IACxB,IAAI,SAAS,eAAe;QAC1B,IAAI,eAAe,qBAAO,8OAAC;sBAAK,cAAA,8OAAC,6JAAe;;;;;;;;;;QAChD,qBAAO,8OAAC;sBAAK,cAAA,8OAAC,4JAAc;;;;;;;;;;IAC9B;IAEA,qBAAqB;IACrB,IAAI,SAAS,YAAY,qBAAO,8OAAC;kBAAK,cAAA,8OAAC,0JAAY;;;;;;;;;;IAEnD,6BAA6B;IAC7B,IAAI,SAAS,YAAY;QACvB,qBACE,8OAAC;sBACC,cAAA,8OAAC,0JAAY;gBACX,aAAa,MAAM,OAAO;gBAC1B,aAAa,UAAU,eAAe;;;;;;;;;;;IAI9C;IAEA,oCAAoC;IACpC,qBAAO,8OAAC;kBAAK,cAAA,8OAAC,6JAAe;;;;;;;;;;AAC/B","debugId":null}}]
}