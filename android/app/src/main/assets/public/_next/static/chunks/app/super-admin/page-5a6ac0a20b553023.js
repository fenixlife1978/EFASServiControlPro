(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[0],{3998:(e,t,s)=>{"use strict";s.d(t,{$:()=>c});var r=s(95155),a=s(12115),n=s(17129),i=s(83101),o=s(64269);let l=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:s,variant:a,size:i,asChild:c=!1,...d}=e,u=c?n.DX:"button";return(0,r.jsx)(u,{className:(0,o.cn)(l({variant:a,size:i,className:s})),ref:t,...d})});c.displayName="Button"},4675:(e,t,s)=>{Promise.resolve().then(s.bind(s,72333))},15894:(e,t,s)=>{"use strict";s.d(t,{dj:()=>u});var r=s(12115);let a=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},o=[],l={toasts:[]};function c(e){l=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(l,e),o.forEach(e=>{e(l)})}function d(e){let{...t}=e,s=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||r()}}}),{id:s,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function u(){let[e,t]=r.useState(l);return r.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},44846:(e,t,s)=>{"use strict";s.d(t,{d:()=>o});var r=s(95155),a=s(12115),n=s(27599),i=s(64269);let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.bL,{className:(0,i.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...a,ref:t,children:(0,r.jsx)(n.zi,{className:(0,i.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});o.displayName=n.bL.displayName},45300:(e,t,s)=>{"use strict";s.d(t,{db:()=>c,j2:()=>l});var r=s(52078),a=s(59253),n=s(19708),i=s(58134);s(13328),s(34491);let o=(0,r.Dk)().length>0?(0,r.Sx)():(0,r.Wp)({apiKey:"AIzaSyACK79dDRclgjFMEUokqpskC1ezyvmO11k",authDomain:"studio-7637044995-2342d.firebaseapp.com",projectId:"studio-7637044995-2342d",storageBucket:"studio-7637044995-2342d.firebasestorage.app",messagingSenderId:"7637044995",appId:"1:7637044995:web:2c6b412952864386927958"}),l=(0,a.xI)(o),c=(0,n.aU)(o);(0,i.c7)(o)},63862:(e,t,s)=>{"use strict";s.d(t,{As:()=>d,BH:()=>h,Ge:()=>x,Jd:()=>c,db:()=>r.db,jt:()=>u,pt:()=>m,ri:()=>l,uN:()=>p,zb:()=>b});var r=s(45300),a=s(13328),n=s(34491),i=s(19708),o=s(59253);let l=async()=>{try{await (0,o.CI)(r.j2),localStorage.removeItem("selectedInstitutionId"),window.location.href="/login"}catch(e){console.error("Error al cerrar sesi\xf3n:",e)}},c=()=>{let[e,t,s]=(0,a.hD)(r.j2);return{user:e,loading:t,error:s}},d=()=>{let[e,t,s]=(0,a.hD)(r.j2);return{user:e,loading:t,error:s,auth:r.j2}},u=()=>r.db,p=n.ZY,x=e=>{if("string"==typeof e&&(!e||e.includes("undefined")||e.includes("null")))return{value:[],loading:!1,error:Error("Ruta de colecci\xf3n inv\xe1lida")};let t="string"==typeof e?(0,i.rJ)(r.db,e):e,[s,a,o]=(0,n.Ar)(t,{idField:"id"});return{value:s||[],loading:a,error:o}},h=async(e,t)=>{try{if(!e||"string"!=typeof e||e.includes("undefined")||e.includes("null"))return console.error("Path inv\xe1lido detectado:",e),{success:!1,error:"Ruta de base de datos no v\xe1lida"};let s=await (0,i.gS)((0,i.rJ)(r.db,e),{...t,createdAt:(0,i.O5)(),updatedAt:(0,i.O5)()});return{success:!0,id:s.id}}catch(e){return console.error("Error addDocument:",e),{success:!1,error:e.message}}},m=async(e,t,s)=>{try{if(!e||!t)throw Error("Colecci\xf3n o ID faltante");return await (0,i.mZ)((0,i.H9)(r.db,e,t),{...s,updatedAt:(0,i.O5)()}),{success:!0}}catch(e){return console.error("Error updateDocument:",e),{success:!1,error:e.message}}},b=async(e,t)=>{try{if(!e||!t)throw Error("Colecci\xf3n o ID faltante");return await (0,i.kd)((0,i.H9)(r.db,e,t)),{success:!0}}catch(e){return console.error("Error deleteDocument:",e),{success:!1,error:e.message}}}},64269:(e,t,s)=>{"use strict";s.d(t,{cn:()=>n});var r=s(2821),a=s(75889);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}},72333:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(95155),a=s(12115),n=s(63862),i=s(19708),o=s(98428),l=s(32265),c=s(92925),d=s(13630),u=s(3998),p=s(44846),x=s(15894),h=s(20063);function m(){let[e,t]=(0,a.useState)([]),[s,m]=(0,a.useState)(!0),[b,g]=(0,a.useState)({nombre:"",institutoId:"",logoUrl:""}),{toast:f}=(0,x.dj)(),v=(0,h.useRouter)();(0,a.useEffect)(()=>{let e=(0,i.P)((0,i.rJ)(n.db,"institutions")),s=(0,i.aQ)(e,e=>{t(e.docs.map(e=>{let t=e.data();return{id:e.id,nombre:t.nombre||"Sin nombre",institutoId:t.InstitutoId||e.id,status:t.status||"published",...t}})),m(!1)});return()=>s()},[]);let y=async()=>{try{await (0,n.ri)()}catch(e){console.error("Error al salir:",e),f({variant:"destructive",title:"Error",description:"No se pudo cerrar la sesi\xf3n correctamente."})}},N=async e=>{if(e.preventDefault(),b.institutoId)try{let e=b.institutoId.trim().toUpperCase(),t=(0,i.H9)(n.db,"institutions",e);await (0,i.BN)(t,{nombre:b.nombre,InstitutoId:e,logoUrl:b.logoUrl,status:"published",createdAt:(0,i.O5)()}),f({title:"\xc9xito",description:"Instituci\xf3n registrada correctamente"}),g({nombre:"",institutoId:"",logoUrl:""})}catch(e){f({title:"Error",description:"Fallo al registrar"})}},j=async(e,t)=>{try{await (0,i.mZ)((0,i.H9)(n.db,"institutions",e),{status:"published"===t?"unpublished":"published"})}catch(e){f({title:"Error",description:"No se pudo cambiar el estado"})}},I=async e=>{if(confirm("\xbfEst\xe1s seguro que deseas eliminar esta instituci\xf3n?"))try{await (0,i.kd)((0,i.H9)(n.db,"institutions",e)),f({title:"Eliminada",description:"Registro borrado permanentemente."})}catch(e){f({title:"Error",description:"No se pudo eliminar.",variant:"destructive"})}};return(0,r.jsxs)("div",{className:"min-h-screen bg-[#0a0c10] text-white p-6 font-sans",children:[(0,r.jsxs)("header",{className:"flex justify-between items-center max-w-7xl mx-auto mb-8",children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)("h1",{className:"text-xl font-black italic tracking-tighter uppercase",children:["EFAS ",(0,r.jsx)("span",{className:"text-orange-500",children:"ServiControlPro"})]})}),(0,r.jsxs)(u.$,{onClick:y,variant:"destructive",size:"sm",className:"bg-red-900/20 hover:bg-red-900/40 text-red-500 border border-red-900/50 italic font-black rounded-lg px-6 transition-all",children:[(0,r.jsx)(o.A,{className:"w-4 h-4 mr-2"})," SALIR"]})]}),(0,r.jsxs)("main",{className:"max-w-7xl mx-auto space-y-6",children:[(0,r.jsx)("section",{className:"bg-[#11141d] border border-white/5 rounded-3xl p-8 shadow-xl",children:(0,r.jsxs)("form",{onSubmit:N,className:"grid grid-cols-1 md:grid-cols-4 gap-6 items-end",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-[10px] font-black text-slate-500 uppercase",children:"Nombre"}),(0,r.jsx)("input",{value:b.nombre,onChange:e=>g({...b,nombre:e.target.value}),className:"w-full bg-[#1c212c] rounded-xl py-4 px-4 text-sm outline-none focus:ring-2 focus:ring-orange-500 text-slate-200",placeholder:"Nombre de la Instituci\xf3n",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-[10px] font-black text-slate-500 uppercase",children:"InstitutoId"}),(0,r.jsx)("input",{value:b.institutoId,onChange:e=>g({...b,institutoId:e.target.value}),className:"w-full bg-[#1c212c] rounded-xl py-4 px-4 text-sm font-mono text-orange-400 outline-none focus:ring-2 focus:ring-orange-500",placeholder:"CAG-001",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-[10px] font-black text-slate-500 uppercase",children:"URL Logo"}),(0,r.jsx)("input",{value:b.logoUrl,onChange:e=>g({...b,logoUrl:e.target.value}),className:"w-full bg-[#1c212c] rounded-xl py-4 px-4 text-sm outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,r.jsxs)(u.$,{type:"submit",className:"bg-orange-600 hover:bg-orange-700 text-white font-black italic rounded-2xl py-7 uppercase shadow-lg shadow-orange-900/20",children:[(0,r.jsx)(l.A,{className:"w-5 h-5 mr-2"})," REGISTRAR"]})]})}),(0,r.jsxs)("section",{className:"bg-white rounded-3xl overflow-hidden shadow-2xl border border-slate-200",children:[(0,r.jsxs)("table",{className:"w-full text-left",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-slate-50 border-b text-slate-800 text-[11px] font-black uppercase",children:[(0,r.jsx)("th",{className:"px-8 py-5",children:"Instituci\xf3n"}),(0,r.jsx)("th",{className:"px-8 py-5",children:"InstitutoId"}),(0,r.jsx)("th",{className:"px-8 py-5",children:"Estado"}),(0,r.jsx)("th",{className:"px-8 py-5 text-right",children:"Acciones"})]})}),(0,r.jsx)("tbody",{className:"text-slate-600 font-bold",children:e.map(e=>(0,r.jsxs)("tr",{className:"border-b border-slate-50 hover:bg-slate-50 transition-colors",children:[(0,r.jsx)("td",{className:"px-8 py-6 text-slate-900",children:e.nombre}),(0,r.jsx)("td",{className:"px-8 py-6",children:(0,r.jsx)("span",{className:"bg-orange-100 text-orange-700 px-3 py-1 rounded-md text-xs font-black",children:e.InstitutoId})}),(0,r.jsx)("td",{className:"px-8 py-6",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(p.d,{checked:"published"===e.status,onCheckedChange:()=>j(e.id,e.status)}),(0,r.jsx)("span",{className:"text-[10px] font-black uppercase ".concat("published"===e.status?"text-emerald-500":"text-slate-400"),children:"published"===e.status?"● Publicado":"○ Borrador"})]})}),(0,r.jsx)("td",{className:"px-8 py-6 text-right",children:(0,r.jsxs)("div",{className:"flex justify-end items-center gap-2",children:[(0,r.jsxs)(u.$,{onClick:()=>{localStorage.setItem("selectedInstitutionId",e.id),v.push("/dashboard")},variant:"outline",className:"border-orange-200 text-orange-600 font-black italic text-xs rounded-xl uppercase hover:bg-orange-50",children:[(0,r.jsx)(c.A,{className:"w-3 h-3 mr-2"})," GESTIONAR"]}),(0,r.jsx)(u.$,{onClick:()=>I(e.id),variant:"ghost",size:"icon",className:"text-slate-400 hover:text-red-500 hover:bg-red-50 rounded-xl",children:(0,r.jsx)(d.A,{className:"w-4 h-4"})})]})})]},e.id))})]}),s&&(0,r.jsx)("div",{className:"p-10 text-center font-black text-slate-300",children:"CARGANDO..."})]})]})]})}}},e=>{e.O(0,[992,644,909,982,500,441,255,358],()=>e(e.s=4675)),_N_E=e.O()}]);